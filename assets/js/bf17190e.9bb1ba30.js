"use strict";(self.webpackChunkxxtouch_lite=self.webpackChunkxxtouch_lite||[]).push([[5744],{7978:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"lua-manual/screen","title":"Screen Module","description":"Screen Module - screen","source":"@site/docs/lua-manual/screen.md","sourceDirName":"lua-manual","slug":"/lua-manual/screen","permalink":"/docs/lua-manual/screen","draft":false,"unlisted":false,"editUrl":"https://github.com/OwnGoalStudio/XXTouchElite/tree/main/docs/lua-manual/screen.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"luaManualSidebar","previous":{"title":"Application Module","permalink":"/docs/lua-manual/app"},"next":{"title":"Image Module","permalink":"/docs/lua-manual/img"}}');var t=i(4848),s=i(8453);const l={sidebar_position:4},c="Screen Module",a={},o=[{value:"Screen Module - screen",id:"screen-module---screen",level:2},{value:"Initialize Rotated Coordinate System (<strong>screen.init</strong>)",id:"initialize-rotated-coordinate-system-screeninit",level:3},{value:"Declaration",id:"declaration",level:4},{value:"Parameters and Return Values",id:"parameters-and-return-values",level:4},{value:"Description",id:"description",level:4},{value:"Example",id:"example",level:4},{value:"Get Rotated Coordinate System (<strong>screen.orientation</strong>)",id:"get-rotated-coordinate-system-screenorientation",level:3},{value:"Declaration",id:"declaration-1",level:4},{value:"Parameters and Return Values",id:"parameters-and-return-values-1",level:4},{value:"Description",id:"description-1",level:4},{value:"Coordinate Rotation Conversion (<strong>screen.rotate_xy</strong>)",id:"coordinate-rotation-conversion-screenrotate_xy",level:3},{value:"Declaration",id:"declaration-2",level:4},{value:"Parameters and Return Values",id:"parameters-and-return-values-2",level:4},{value:"Description",id:"description-2",level:4},{value:"Example",id:"example-1",level:4},{value:"Get Screen Size (<strong>screen.size</strong>)",id:"get-screen-size-screensize",level:3},{value:"Declaration",id:"declaration-3",level:4},{value:"Parameters and Return Values",id:"parameters-and-return-values-3",level:4},{value:"Description",id:"description-3",level:4},{value:"Example",id:"example-2",level:4},{value:"\ud83d\udcf2 Screen Keep (<strong>screen.keep</strong>)",id:"-screen-keep-screenkeep",level:3},{value:"Declaration",id:"declaration-4",level:4},{value:"Parameters and Return Values",id:"parameters-and-return-values-4",level:4},{value:"Description",id:"description-4",level:4},{value:"Example",id:"example-3",level:4},{value:"Exit Screen Keep State (<strong>screen.unkeep</strong>)",id:"exit-screen-keep-state-screenunkeep",level:3},{value:"Declaration",id:"declaration-5",level:4},{value:"Parameters and Return Values",id:"parameters-and-return-values-5",level:4},{value:"Description",id:"description-5",level:4},{value:"Example",id:"example-4",level:4},{value:"\ud83d\udcf2 Get Color of a Point on the Screen (<strong>screen.get_color</strong>)",id:"-get-color-of-a-point-on-the-screen-screenget_color",level:3},{value:"Declaration",id:"declaration-6",level:4},{value:"Parameters and Return Values",id:"parameters-and-return-values-6",level:4},{value:"Example",id:"example-5",level:4},{value:"\ud83d\udcf2 Get RGB Color of a Point on the Screen (<strong>screen.get_color_rgb</strong>)",id:"-get-rgb-color-of-a-point-on-the-screen-screenget_color_rgb",level:3},{value:"Declaration",id:"declaration-7",level:4},{value:"Parameters and Return Values",id:"parameters-and-return-values-7",level:4},{value:"Example",id:"example-6",level:4},{value:"\ud83d\udcf2 Screen Multi-point Color Matching (<strong>screen.is_colors</strong>)",id:"-screen-multi-point-color-matching-screenis_colors",level:3},{value:"Declaration",id:"declaration-8",level:4},{value:"Parameters and Return Values",id:"parameters-and-return-values-8",level:4},{value:"Description",id:"description-6",level:4},{value:"Example",id:"example-7",level:4},{value:"\ud83d\udcf2 Multi-point Similarity Mode Color Finding (<strong>screen.find_color</strong>)",id:"-multi-point-similarity-mode-color-finding-screenfind_color",level:3},{value:"Declaration",id:"declaration-9",level:4},{value:"Parameters and Return Values",id:"parameters-and-return-values-9",level:4},{value:"Description",id:"description-7",level:4},{value:"Example",id:"example-8",level:4},{value:"\ud83d\udcf2 Multi-point Color Deviation Mode Color Finding (<strong>screen.find_color</strong>)",id:"-multi-point-color-deviation-mode-color-finding-screenfind_color",level:3},{value:"Declaration",id:"declaration-10",level:4},{value:"Parameters and Return Values",id:"parameters-and-return-values-10",level:4},{value:"Description",id:"description-8",level:4},{value:"Example",id:"example-9",level:4},{value:"\ud83d\udcf2\ud83c\udf1f Capture Screen Content (<strong>screen.image</strong>)",id:"-capture-screen-content-screenimage",level:3},{value:"Declaration",id:"declaration-11",level:4},{value:"Parameters and Return Values",id:"parameters-and-return-values-11",level:4},{value:"Description",id:"description-9",level:4},{value:"Example",id:"example-10",level:4},{value:"\ud83d\udcf2 Screen Image Finding (<strong>screen.find_image</strong>)",id:"-screen-image-finding-screenfind_image",level:3},{value:"Declaration",id:"declaration-12",level:4},{value:"Parameters and Return Values",id:"parameters-and-return-values-12",level:4},{value:"Description",id:"description-10",level:4},{value:"Example 1",id:"example-1-1",level:4},{value:"Example 2",id:"example-2-1",level:4},{value:"Example 3",id:"example-3-1",level:4},{value:"Example 4",id:"example-4-1",level:4},{value:"\ud83d\udcf2 Screen Optical Character Recognition (<strong>screen.ocr_text</strong>)",id:"-screen-optical-character-recognition-screenocr_text",level:3},{value:"Declaration 1",id:"declaration-1-1",level:4},{value:"Declaration 2",id:"declaration-2-1",level:4},{value:"Declaration 3",id:"declaration-3-1",level:4},{value:"Parameters and Return Values",id:"parameters-and-return-values-13",level:4},{value:"Description",id:"description-11",level:4},{value:"Example <code>screen.ocr_search</code>",id:"example-screenocr_search",level:4},{value:"Example <code>screen.ocr_match</code>",id:"example-screenocr_match",level:4},{value:"\ud83d\udcf2 Tesseract Screen Optical Character Recognition (<strong>screen.tess_ocr</strong>)",id:"-tesseract-screen-optical-character-recognition-screentess_ocr",level:3},{value:"Declaration 1",id:"declaration-1-2",level:4},{value:"Declaration 2",id:"declaration-2-2",level:4},{value:"Parameters and Return Values",id:"parameters-and-return-values-14",level:4},{value:"Description",id:"description-12",level:4},{value:"Example",id:"example-11",level:4},{value:"\ud83d\udcf2 Screen QR Code Recognition (<strong>screen.qr_decode</strong>)",id:"-screen-qr-code-recognition-screenqr_decode",level:3},{value:"Declaration",id:"declaration-13",level:4},{value:"Parameters and Return Values",id:"parameters-and-return-values-15",level:4},{value:"Description",id:"description-13",level:4},{value:"Example: Decode a local QR code image file",id:"example-decode-a-local-qr-code-image-file",level:4},{value:"Example: Decode the QR code displayed on the current screen",id:"example-decode-the-qr-code-displayed-on-the-current-screen",level:4},{value:"\ud83d\udcf2 Screen Rectangle Detection (<strong>screen.detect_rectangles</strong>)",id:"-screen-rectangle-detection-screendetect_rectangles",level:3},{value:"Declaration 1",id:"declaration-1-3",level:4},{value:"Declaration 2",id:"declaration-2-3",level:4},{value:"Declaration 3",id:"declaration-3-2",level:4},{value:"Parameters and Return Values",id:"parameters-and-return-values-16",level:4},{value:"Description",id:"description-14",level:4},{value:"Example: Capture a card on the screen and save to album",id:"example-capture-a-card-on-the-screen-and-save-to-album",level:4}];function d(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"screen-module",children:"Screen Module"})}),"\n",(0,t.jsx)(n.h2,{id:"screen-module---screen",children:"Screen Module - screen"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Functions marked with \ud83c\udf1f will generate a new ",(0,t.jsx)(n.a,{href:"/docs/lua-manual/img#image-object",children:(0,t.jsx)(n.em,{children:"image object"})}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Functions marked with \ud83d\udcf2 will implicitly capture the current screen content when not in ",(0,t.jsx)(n.strong,{children:"Screen Keep State"}),", see ",(0,t.jsx)(n.a,{href:"#-screen-keep-screenkeep",children:"Screen Keep"})," for details."]}),"\n"]}),"\n",(0,t.jsxs)(n.h3,{id:"initialize-rotated-coordinate-system-screeninit",children:["Initialize Rotated Coordinate System (",(0,t.jsx)(n.strong,{children:"screen.init"}),")"]}),"\n",(0,t.jsx)(n.h4,{id:"declaration",children:"Declaration"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:"original_coordinate_system = screen.init(coordinate_system)\n"})}),"\n",(0,t.jsx)(n.h4,{id:"parameters-and-return-values",children:"Parameters and Return Values"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["coordinate_system ",(0,t.jsx)(n.em,{children:"enum"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"0"})," indicates portrait mode with HOME at the bottom"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"1"})," indicates landscape mode with HOME on the right"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"2"})," indicates landscape mode with HOME on the left"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"3"})," indicates portrait mode with HOME at the top"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["original_coordinate_system","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"enum"}),", returns the coordinate system used before this function call"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"description",children:"Description"}),"\n",(0,t.jsxs)(n.p,{children:["Initializes the coordinate system shared by the ",(0,t.jsx)(n.strong,{children:"Screen Module"})," and the ",(0,t.jsx)(n.strong,{children:"Simulated Touch Module"}),"."]}),"\n",(0,t.jsxs)(n.admonition,{type:"info",children:[(0,t.jsx)(n.p,{children:"The following aliases can also achieve the same effect:"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:"screen.init_home_on_bottom()    -- HOME at the bottom\nscreen.init_home_on_right()     -- HOME on the right\nscreen.init_home_on_left()      -- HOME on the left\nscreen.init_home_on_top()       -- HOME at the top\n"})})]}),"\n",(0,t.jsx)(n.h4,{id:"example",children:"Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",metastring:'title="screen.init"',children:"screen.init(0)    -- HOME at the bottom\nscreen.init(1)    -- HOME on the right\nscreen.init(2)    -- HOME on the left\nscreen.init(3)    -- HOME at the top\n"})}),"\n",(0,t.jsxs)(n.h3,{id:"get-rotated-coordinate-system-screenorientation",children:["Get Rotated Coordinate System (",(0,t.jsx)(n.strong,{children:"screen.orientation"}),")"]}),"\n",(0,t.jsx)(n.h4,{id:"declaration-1",children:"Declaration"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:"coordinate_system = screen.orientation()\n"})}),"\n",(0,t.jsx)(n.h4,{id:"parameters-and-return-values-1",children:"Parameters and Return Values"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["coordinate_system ",(0,t.jsx)(n.em,{children:"enum"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"0"})," indicates portrait mode with HOME at the bottom"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"1"})," indicates landscape mode with HOME on the right"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"2"})," indicates landscape mode with HOME on the left"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"3"})," indicates portrait mode with HOME at the top"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"description-1",children:"Description"}),"\n",(0,t.jsxs)(n.p,{children:["Gets the current coordinate system shared by the ",(0,t.jsx)(n.strong,{children:"Screen Module"})," and the ",(0,t.jsx)(n.strong,{children:"Simulated Touch Module"}),"."]}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"screen.ORIENTATION_HOME_ON_BOTTOM"})," indicates portrait mode with HOME at the bottom"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"screen.ORIENTATION_HOME_ON_RIGHT"})," indicates landscape mode with HOME on the right"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"screen.ORIENTATION_HOME_ON_LEFT"})," indicates landscape mode with HOME on the left"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"screen.ORIENTATION_HOME_ON_TOP"})," indicates portrait mode with HOME at the top"]}),"\n"]})}),"\n",(0,t.jsxs)(n.h3,{id:"coordinate-rotation-conversion-screenrotate_xy",children:["Coordinate Rotation Conversion (",(0,t.jsx)(n.strong,{children:"screen.rotate_xy"}),")"]}),"\n",(0,t.jsx)(n.h4,{id:"declaration-2",children:"Declaration"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:"rotated_x, rotated_y = screen.rotate_xy(x, y, rotation)\n"})}),"\n",(0,t.jsx)(n.h4,{id:"parameters-and-return-values-2",children:"Parameters and Return Values"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["x, y","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", coordinates to be rotated"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["rotation ",(0,t.jsx)(n.em,{children:"integer"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"0"})," indicates no rotation"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"1"})," indicates 90 degrees counterclockwise rotation"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"2"})," indicates 90 degrees clockwise rotation"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"3"})," indicates 180 degrees rotation"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["rotated_x, rotated_y","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", returns the coordinates after rotation based on the ",(0,t.jsx)(n.strong,{children:"rotation"})," option"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"description-2",children:"Description"}),"\n",(0,t.jsx)(n.p,{children:"Coordinate rotation conversion, usually used to convert portrait coordinates to landscape coordinates."}),"\n",(0,t.jsx)(n.h4,{id:"example-1",children:"Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",metastring:'title="screen.rotate_xy"',children:"rx, ry = screen.rotate_xy(100, 200, 1)\n"})}),"\n",(0,t.jsxs)(n.h3,{id:"get-screen-size-screensize",children:["Get Screen Size (",(0,t.jsx)(n.strong,{children:"screen.size"}),")"]}),"\n",(0,t.jsx)(n.h4,{id:"declaration-3",children:"Declaration"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:"screen_width, screen_height = screen.size()\n"})}),"\n",(0,t.jsx)(n.h4,{id:"parameters-and-return-values-3",children:"Parameters and Return Values"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["screen_width ",(0,t.jsx)(n.em,{children:"integer"})]}),"\n",(0,t.jsxs)(n.li,{children:["screen_height ",(0,t.jsx)(n.em,{children:"integer"})]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"description-3",children:"Description"}),"\n",(0,t.jsxs)(n.p,{children:["The screen size after iOS system scaling and resampling, in ",(0,t.jsx)(n.strong,{children:"pixels"}),"."]}),"\n",(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsxs)(n.p,{children:["The return value is not affected by the current orientation of the springboard or application, but is affected by the ",(0,t.jsx)(n.strong,{children:"zoom mode"}),"."]})}),"\n",(0,t.jsx)(n.h4,{id:"example-2",children:"Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",metastring:'title="screen.size"',children:"-- Determine device type based on resolution\nlocal width, height = screen.size()\nif width == 750 and height == 1334 then\n  -- Standard mode iPhone 6S, 7, 8\nelseif width == 640 and height == 1136 then\n  -- Zoom mode iPhone 6S, 7, 8\nend\n"})}),"\n",(0,t.jsxs)(n.h3,{id:"-screen-keep-screenkeep",children:["\ud83d\udcf2 Screen Keep (",(0,t.jsx)(n.strong,{children:"screen.keep"}),")"]}),"\n",(0,t.jsx)(n.h4,{id:"declaration-4",children:"Declaration"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:"screen_capture_count = screen.keep()\n"})}),"\n",(0,t.jsx)(n.h4,{id:"parameters-and-return-values-4",children:"Parameters and Return Values"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["screen_capture_count","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", returns the number of times the current ",(0,t.jsx)(n.a,{href:"/docs/appendix/process-scheduling",children:"script process"})," has captured the screen content"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"description-4",children:"Description"}),"\n",(0,t.jsxs)(n.p,{children:["Captures a copy of the current screen content in the current script process and enters ",(0,t.jsx)(n.strong,{children:"Screen Keep State"}),", incrementing the ",(0,t.jsx)(n.strong,{children:"screen capture count"}),"."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["In ",(0,t.jsx)(n.strong,{children:"Screen Keep State"}),", multiple calls to color picking, color finding, screenshot, or image finding functions marked with \ud83d\udcf2 will continue to operate based on the kept copy without repeatedly capturing new screen content."]}),"\n",(0,t.jsxs)(n.li,{children:["In ",(0,t.jsx)(n.strong,{children:"Screen Keep State"}),", the ",(0,t.jsx)(n.strong,{children:"screen capture count"})," will not increase."]}),"\n",(0,t.jsxs)(n.li,{children:["Call the ",(0,t.jsx)(n.a,{href:"#exit-screen-keep-state-screenunkeep",children:(0,t.jsx)(n.code,{children:"screen.unkeep"})})," function to exit ",(0,t.jsx)(n.strong,{children:"Screen Keep State"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["Only refreshes the data source for functions marked with \ud83d\udcf2, and ",(0,t.jsx)(n.strong,{children:"does not"})," cause the actual screen display to freeze."]})}),"\n",(0,t.jsx)(n.h4,{id:"example-3",children:"Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",metastring:'title="screen.keep"',children:'screen.keep()    -- Keep screen\nfor k = 1, 640, 10 do\n  for j = 1, 960, 10 do\n    color = string.format("%X", screen.get_color(k, j))  -- Format as hexadecimal text\n    sys.log("("..k..", "..j..") Color: "..color..".")    -- Output to system log\n  end\nend\nscreen.unkeep()  -- Exit screen keep state\n'})}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Consecutive separate calls to ",(0,t.jsx)(n.a,{href:"#-get-color-of-a-point-on-the-screen-screenget_color",children:(0,t.jsx)(n.code,{children:"screen.get_color"})})," for the same position may return different values."]}),"\n",(0,t.jsxs)(n.li,{children:["In the case of ",(0,t.jsx)(n.code,{children:"screen.keep"}),", a single call to ",(0,t.jsx)(n.a,{href:"#-get-color-of-a-point-on-the-screen-screenget_color",children:(0,t.jsx)(n.code,{children:"screen.get_color"})})," will take longer than a single call to ",(0,t.jsx)(n.code,{children:"screen.keep"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["After calling ",(0,t.jsx)(n.code,{children:"screen.keep"}),", calling ",(0,t.jsx)(n.a,{href:"#-get-color-of-a-point-on-the-screen-screenget_color",children:(0,t.jsx)(n.code,{children:"screen.get_color"})})," 50 times consecutively will take the same time as calling ",(0,t.jsx)(n.code,{children:"screen.keep"})," once."]}),"\n"]})}),"\n",(0,t.jsxs)(n.h3,{id:"exit-screen-keep-state-screenunkeep",children:["Exit Screen Keep State (",(0,t.jsx)(n.strong,{children:"screen.unkeep"}),")"]}),"\n",(0,t.jsx)(n.h4,{id:"declaration-5",children:"Declaration"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:"screen_capture_count = screen.unkeep()\n"})}),"\n",(0,t.jsx)(n.h4,{id:"parameters-and-return-values-5",children:"Parameters and Return Values"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["screen_capture_count","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", returns the number of times the current ",(0,t.jsx)(n.a,{href:"/docs/appendix/process-scheduling",children:"script process"})," has captured the screen content"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"description-5",children:"Description"}),"\n",(0,t.jsxs)(n.p,{children:["Cancels the effect of the ",(0,t.jsx)(n.a,{href:"#-screen-keep-screenkeep",children:(0,t.jsx)(n.code,{children:"screen.keep"})})," function and exits ",(0,t.jsx)(n.strong,{children:"Screen Keep State"}),".\nAfter exiting ",(0,t.jsx)(n.strong,{children:"Screen Keep State"}),", each call to color picking, color finding, screenshot, or image finding functions marked with \ud83d\udcf2 will capture new screen content, incrementing the ",(0,t.jsx)(n.strong,{children:"screen capture count"}),"."]}),"\n",(0,t.jsx)(n.h4,{id:"example-4",children:"Example"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsxs)(n.a,{href:"#-screen-keep-screenkeep",children:["Refer to the ",(0,t.jsx)(n.code,{children:"screen.keep"})," example"]})}),"\n"]}),"\n",(0,t.jsxs)(n.h3,{id:"-get-color-of-a-point-on-the-screen-screenget_color",children:["\ud83d\udcf2 Get Color of a Point on the Screen (",(0,t.jsx)(n.strong,{children:"screen.get_color"}),")"]}),"\n",(0,t.jsx)(n.h4,{id:"declaration-6",children:"Declaration"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:"color_value = screen.get_color(x, y)\n"})}),"\n",(0,t.jsx)(n.h4,{id:"parameters-and-return-values-6",children:"Parameters and Return Values"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["x, y","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", coordinates of the target point"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["color_value","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", returns the RGB value of the color at the target point"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"example-5",children:"Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",metastring:'title="screen.get_color"',children:'local c = screen.get_color(512, 133)\nif c == 0xffffff then\n  sys.alert("The color at (512,133) is pure white")\nend\n'})}),"\n",(0,t.jsxs)(n.h3,{id:"-get-rgb-color-of-a-point-on-the-screen-screenget_color_rgb",children:["\ud83d\udcf2 Get RGB Color of a Point on the Screen (",(0,t.jsx)(n.strong,{children:"screen.get_color_rgb"}),")"]}),"\n",(0,t.jsx)(n.h4,{id:"declaration-7",children:"Declaration"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:"red, green, blue = screen.get_color_rgb(x, y)\n"})}),"\n",(0,t.jsx)(n.h4,{id:"parameters-and-return-values-7",children:"Parameters and Return Values"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["x, y","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", coordinates of the target point"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["red, green, blue","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", returns the R, G, B values of the color at the target point, range 0 ~ 255"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"example-6",children:"Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",metastring:'title="screen.get_color_rgb"',children:'local r, g, b = screen.get_color_rgb(512, 133)\nif r == 0xff and g == 0xff and b == 0xff then\n  sys.alert("The color at (512,133) is pure white")\nend\n'})}),"\n",(0,t.jsxs)(n.h3,{id:"-screen-multi-point-color-matching-screenis_colors",children:["\ud83d\udcf2 Screen Multi-point Color Matching (",(0,t.jsx)(n.strong,{children:"screen.is_colors"}),")"]}),"\n",(0,t.jsx)(n.h4,{id:"declaration-8",children:"Declaration"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:"is_exact_match = screen.is_colors({\n    {x*, y*, color*},\n    {x*, y*, color*},\n    ...\n}[, color_similarity])\n"})}),"\n",(0,t.jsx)(n.h4,{id:"parameters-and-return-values-8",children:"Parameters and Return Values"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["x*, y*","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", coordinates of a point"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["color*","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", color value to match at a point"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["color_similarity","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", ",(0,t.jsx)(n.em,{children:"optional"}),", similarity of the color, range 1 ~ 100, default ",(0,t.jsx)(n.code,{children:"100"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["is_exact_match","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"boolean"}),", returns ",(0,t.jsx)(n.code,{children:"true"})," if all points match, otherwise returns ",(0,t.jsx)(n.code,{children:"false"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"description-6",children:"Description"}),"\n",(0,t.jsx)(n.p,{children:"Matches the colors of several points on the screen."}),"\n",(0,t.jsx)(n.h4,{id:"example-7",children:"Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",metastring:'title="screen.is_colors"',children:'if screen.is_colors({\n  { 509, 488, 0xec1c23 },  -- If the color at (509, 488) is similar to 0xec1c23 by 90% or more\n  { 514, 470, 0x00adee },  -- And the color at (514, 470) is similar to 0x00adee by 90% or more\n  { 508, 478, 0xffc823 },  -- And the color at (508, 478) is similar to 0xffc823 by 90% or more\n  { 511, 454, 0xa78217 },  -- And the color at (511, 454) is similar to 0xa78217 by 90% or more\n  { 521, 433, 0xd0d2d2 },  -- And the color at (521, 433) is similar to 0xd0d2d2 by 90% or more\n}, 90) then                -- Then it matches\n  sys.alert("Match!")\nelse\n  sys.alert("No match!")\nend\n'})}),"\n",(0,t.jsxs)(n.h3,{id:"-multi-point-similarity-mode-color-finding-screenfind_color",children:["\ud83d\udcf2 Multi-point Similarity Mode Color Finding (",(0,t.jsx)(n.strong,{children:"screen.find_color"}),")"]}),"\n",(0,t.jsx)(n.h4,{id:"declaration-9",children:"Declaration"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:"x, y = screen.find_color({\n    [find_all = search_multiple_results],\n    [max_results = max_results],\n    [max_miss = max_miss],\n    {start_x, start_y, start_color[, start_similarity]},\n    {offset_x*, offset_y*, offset_color*[, offset_similarity*]},\n    {offset_x*, offset_y*, offset_color*[, offset_similarity*]},\n    ...\n}[, global_similarity, left, top, right, bottom])\n"})}),"\n",(0,t.jsx)(n.h4,{id:"parameters-and-return-values-9",children:"Parameters and Return Values"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["search_multiple_results","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"boolean"}),", ",(0,t.jsx)(n.em,{children:"optional"}),", if set to ",(0,t.jsx)(n.code,{children:"true"}),", returns a table of all matching positions within the range, format ",(0,t.jsx)(n.code,{children:"{{x1, y1}, {x2, y2}, ...}"}),", default ",(0,t.jsx)(n.code,{children:"false"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["max_results","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", ",(0,t.jsx)(n.em,{children:"optional"}),", when the ",(0,t.jsx)(n.code,{children:"find_all"})," (search_multiple_results) tag is set to ",(0,t.jsx)(n.code,{children:"true"}),", this indicates the maximum number of results to return, up to ",(0,t.jsx)(n.code,{children:"1000"}),", default ",(0,t.jsx)(n.code,{children:"100"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["max_miss","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", ",(0,t.jsx)(n.em,{children:"optional"}),", allows the maximum number of unmatched points, default ",(0,t.jsx)(n.code,{children:"0"}),", meaning all points must match to be found"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["start_x, start_y","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", starting coordinates, not limiting the search range to this point, but giving a relative coordinate for the offset position, if not understood, fill in ",(0,t.jsx)(n.code,{children:"0, 0"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["start_color","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", color to search for at the starting point"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["start_similarity","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", ",(0,t.jsx)(n.em,{children:"optional"}),", similarity of the color at the starting point, range 1 ~ 100, default ",(0,t.jsx)(n.code,{children:"100"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["offset_x*, offset_y*","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", coordinates of an offset position"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["offset_color*","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", color to match at the offset position"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["offset_similarity*","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", ",(0,t.jsx)(n.em,{children:"optional"}),", similarity of the color at the offset position, range -100 ~ 100, default ",(0,t.jsx)(n.code,{children:"100"}),", negative similarity means matching less than the absolute value of the similarity"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["global_similarity","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", ",(0,t.jsx)(n.em,{children:"optional"}),", if no individual point similarity is set, then each point will use this similarity, range 1 ~ 100, default ",(0,t.jsx)(n.code,{children:"100"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["left, top, right, bottom","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", ",(0,t.jsx)(n.em,{children:"optional"}),", coordinates of the top-left and bottom-right corners of the search area, default ",(0,t.jsx)(n.strong,{children:"full screen"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["x, y","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", returns the coordinates of the first matching color, search failure returns ",(0,t.jsx)(n.code,{children:"-1, -1"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"description-7",children:"Description"}),"\n",(0,t.jsx)(n.p,{children:"Uses similarity mode to find (pattern matching) the position of the first fully matching multi-point color structure (pattern) in the area."}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["No body ",(0,t.jsx)(n.a,{href:"/docs/tutorial/make-some-notes#find-new-note-button",children:"writes this matching table by hand"}),", right?"]})}),"\n",(0,t.jsx)(n.h4,{id:"example-8",children:"Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",metastring:'title="screen.find_color"',children:"x, y = screen.find_color({\n  {  0,   0, 0xec1c23 },\n  { 12,  -3, 0xffffff, 85 },\n  {  5, -18, 0x00adee },\n  { -1, -10, 0xffc823 },\n  {  2, -34, 0xa78217 },\n  { 12, -55, 0xd0d2d2 },\n}, 90, 0, 0, 100, 100)\n--\n--[[\n  In the area with the top-left corner at 0, 0 and the bottom-right corner at 100, 100, find the first point with a color similar to 0xec1c23 by more than 90%\n  And its relative coordinate (12, -3) has a color similar to 0xffffff by more than 85%\n  And its relative coordinate (5, -18) has a color similar to 0x00adee by more than 90%\n  And ... (same for the rest) all match\n--]]\n--\n-- Equivalent code:\n--\nx, y = screen.find_color({\n  { 509, 488, 0xec1c23 },\n  { 521, 485, 0xffffff, 85 },\n  { 514, 470, 0x00adee },\n  { 508, 478, 0xffc823 },\n  { 511, 454, 0xa78217 },\n  { 521, 433, 0xd0d2d2 },\n}, 90, 0, 0, 100, 100)\n--\n--[[\n  In the area with the top-left corner at 0, 0 and the bottom-right corner at 100, 100, find the first point with a color similar to 0xec1c23 by more than 90%\n  And its relative coordinate (521-509, 485-488) has a color similar to 0xffffff by more than 85%\n  And its relative coordinate (514-509, 470-488) has a color similar to 0x00adee by more than 90%\n  And ... (same for the rest) all match\n--]]\n--\n-- Without line breaks and indentation, it looks like this:\nx, y = screen.find_color({ {0,0,0xec1c23},{12,-3,0xffffff,85},{5,-18,0x00adee},{-1,-10,0xffc823},{2,-34,0xa78217},{12,-55,0xd0d2d2} }, 90, 0, 0, 100, 100)\n--\nx, y = screen.find_color({  -- Reverse matching example, can get results on 5C main screen\n  { 516,  288, 0xffffff },\n  { 519,  286, 0xffffff },\n  { 521,  289, 0xffffff },\n  { 516,  296, 0xffffff },\n  { 522,  297, 0xffffff },\n  { 520,  295, 0xffffff, -10 },  -- This point matches if the color is less than 10% similar to 0xffffff, same below\n  { 515,  291, 0xffffff, -10 },\n  { 518,  284, 0xffffff, -10 },\n  { 523,  298, 0xffffff, -10 },\n  { 514,  298, 0xffffff, -10 },\n  { 514,  296, 0xffffff, -10 },\n}, 90)  -- No area parameters means full screen search\n--\nresults = screen.find_color({  -- Range matching full output example\n  {  527,  278, 0xde1d26 },\n  {  524,  285, 0x007aff },\n  {  555,  292, 0xe4ddc9 },\n  {  536,  314, 0xffde02 },\n  {  502,  291, 0xffde02 },\n  {  502,  283, 0xe4ddc9 },\n  find_all = true,  -- With this tag, it will return a table of all matching positions within the range, format { {x1, y1}, {x2, y2}, ... }\n}, 90)  -- No area parameters means full screen search\n"})}),"\n",(0,t.jsxs)(n.h3,{id:"-multi-point-color-deviation-mode-color-finding-screenfind_color",children:["\ud83d\udcf2 Multi-point Color Deviation Mode Color Finding (",(0,t.jsx)(n.strong,{children:"screen.find_color"}),")"]}),"\n",(0,t.jsx)(n.h4,{id:"declaration-10",children:"Declaration"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:"x, y = screen.find_color({\n    [find_all = search_multiple_results],\n    [max_results = max_results],\n    [max_miss = max_miss],\n    {start_x, start_y, {start_color[, start_deviation]}},\n    {offset_x*, offset_y*, {offset_color*[, offset_deviation*]}},\n    {offset_x*, offset_y*, {offset_color*[, offset_deviation*]}},\n    ...\n}[, left, top, right, bottom])\n"})}),"\n",(0,t.jsx)(n.h4,{id:"parameters-and-return-values-10",children:"Parameters and Return Values"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["search_multiple_results","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"boolean"}),", ",(0,t.jsx)(n.em,{children:"optional"}),", if set to ",(0,t.jsx)(n.code,{children:"true"}),", returns a table of all matching positions within the range, format ",(0,t.jsx)(n.code,{children:"{{x1, y1}, {x2, y2}, ...}"}),", default ",(0,t.jsx)(n.code,{children:"false"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["max_results","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", ",(0,t.jsx)(n.em,{children:"optional"}),", when the ",(0,t.jsx)(n.code,{children:"find_all"})," (search_multiple_results) tag is set to ",(0,t.jsx)(n.code,{children:"true"}),", this indicates the maximum number of results to return, up to ",(0,t.jsx)(n.code,{children:"1000"}),", default ",(0,t.jsx)(n.code,{children:"100"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["max_miss","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", ",(0,t.jsx)(n.em,{children:"optional"}),", allows the maximum number of unmatched points, default ",(0,t.jsx)(n.code,{children:"0"}),", meaning all points must match to be found"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["start_x, start_y","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", starting coordinates, not limiting the search range to this point, but giving a relative coordinate for the offset position, if not understood, fill in ",(0,t.jsx)(n.code,{children:"0, 0"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["start_color","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", color to search for at the starting point"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["start_deviation","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", maximum color deviation for the color to search for, greater than ",(0,t.jsx)(n.code,{children:"0xff000000"})," indicates reverse matching mode"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["offset_x*, offset_y*","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", coordinates of an offset position"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["offset_color*","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", color to match at the offset position"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["offset_deviation*","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", color deviation for the offset position, greater than ",(0,t.jsx)(n.code,{children:"0xff000000"})," indicates reverse matching mode"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["left, top, right, bottom","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", ",(0,t.jsx)(n.em,{children:"optional"}),", coordinates of the top-left and bottom-right corners of the search area, default ",(0,t.jsx)(n.strong,{children:"full screen"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["x, y","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", returns the coordinates of the first matching color, search failure returns ",(0,t.jsx)(n.code,{children:"-1, -1"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"description-8",children:"Description"}),"\n",(0,t.jsx)(n.p,{children:"Uses color deviation mode to find (pattern matching) the position of the first fully matching multi-point color structure (pattern) in the area."}),"\n",(0,t.jsxs)(n.admonition,{type:"note",children:[(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Color Deviation"})," is used to indicate the range of color deviation. A color with a color deviation means all colors within the red, green, and blue deviation range of that color.\nWhen ",(0,t.jsx)(n.code,{children:"0x456789"})," has a color deviation of ",(0,t.jsx)(n.code,{children:"0x123456"}),", it means the red range is ",(0,t.jsx)(n.code,{children:"0x45 \xb1 0x12"}),", the green range is ",(0,t.jsx)(n.code,{children:"0x67 \xb1 0x34"}),", and the blue range is ",(0,t.jsx)(n.code,{children:"0x89 \xb1 0x56"}),".\nAs shown in the table below, ",(0,t.jsx)(n.code,{children:"{0x456789, 0x123456}"})," represents all colors from ",(0,t.jsx)(n.code,{children:"0x333333"})," to ",(0,t.jsx)(n.code,{children:"0x579BDF"}),"."]}),(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Negative Deviation"}),(0,t.jsx)(n.th,{children:"Positive Deviation"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"0x45 - 0x12 = 0x33"}),(0,t.jsx)(n.td,{children:"0x45 + 0x12 = 0x57"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"0x67 - 0x34 = 0x33"}),(0,t.jsx)(n.td,{children:"0x67 + 0x34 = 0x9B"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"0x89 - 0x56 = 0x33"}),(0,t.jsx)(n.td,{children:"0x89 + 0x56 = 0xDF"})]})]})]})]}),"\n",(0,t.jsx)(n.h4,{id:"example-9",children:"Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",metastring:'title="screen.find_color"',children:"x, y = screen.find_color({\n  {  0,   0, {0xec1c23, 0x000000} },\n  { 12,  -3, {0xffffff, 0x101010} },\n  {  5, -18, {0x00adee, 0x123456} },\n  { -1, -10, {0xffc823, 0x101001} },\n  {  2, -34, {0xa78217, 0x101001} },\n  { 12, -55, {0xd0d2d2, 0x101001} },\n}, 0, 0, 100, 100)\n--\n--[[\n  In the area with the top-left corner at 0, 0 and the bottom-right corner at 100, 100, find the first point with a color exactly similar to 0xec1c23 (color deviation is 0)\n  And its relative coordinate (12, -3) has a color deviation less than 0x101010 from 0xffffff\n  And its relative coordinate (5, -18) has a color deviation less than 0x123456 from 0x00adee\n  And ... (same for the rest) all match\n--]]\n--\n-- Equivalent code:\n--\nx, y = screen.find_color({\n  { 509, 488, {0xec1c23, 0x000000} },\n  { 521, 485, {0xffffff, 0x101010} },\n  { 514, 470, {0x00adee, 0x123456} },\n  { 508, 478, {0xffc823, 0x101001} },\n  { 511, 454, {0xa78217, 0x101001} },\n  { 521, 433, {0xd0d2d2, 0x101001} },\n}, 0, 0, 100, 100)\n--\n--[[\n  In the area with the top-left corner at 0, 0 and the bottom-right corner at 100, 100, find the first point with a color exactly similar to 0xec1c23 (color deviation is 0)\n  And its relative coordinate (521-509, 485-488) has a color deviation less than 0x101010 from 0xffffff\n  And its relative coordinate (514-509, 470-488) has a color deviation less than 0x123456 from 0x00adee\n  And ... (same for the rest) all match\n--]]\n--\n-- Without line breaks and indentation, it looks like this:\nx, y = screen.find_color({ {0,0,{0xec1c23,0x000000}},{12,-3,{0xffffff,0x101010}},{5,-18,{0x00adee,0x123456}},{-1,-10,{0xffc823,0x101001}},{2,-34,{0xa78217,0x101001}},{12,-55,{0xd0d2d2,0x101001}} }, 0, 0, 100, 100)\n--\nx, y = screen.find_color({  -- Reverse matching example, can get results on 5C main screen\n  { 516,  288, {0xffffff, 0x101010} },\n  { 519,  286, {0xffffff, 0x101010} },\n  { 521,  289, {0xffffff, 0x101010} },\n  { 516,  296, {0xffffff, 0x101010} },\n  { 522,  297, {0xffffff, 0x101010} },\n  { 520,  295, {0xffffff, 0xff101010} },  -- This point matches if the color deviation is greater than 0x101010 from 0xffffff, same below\n  { 515,  291, {0xffffff, 0xff101010} },\n  { 518,  284, {0xffffff, 0xff101010} },\n  { 523,  298, {0xffffff, 0xff101010} },\n  { 514,  298, {0xffffff, 0xff101010} },\n  { 514,  296, {0xffffff, 0xff101010} },\n})  -- No area parameters means full screen search\n--\nresults = screen.find_color({  -- Range matching full output example\n  {  527,  278, {0xde1d26, 0x101010} },\n  {  524,  285, {0x007aff, 0x101010} },\n  {  555,  292, {0xe4ddc9, 0x101010} },\n  {  536,  314, {0xffde02, 0x101010} },\n  {  502,  291, {0xffde02, 0x101010} },\n  {  502,  283, {0xe4ddc9, 0x101010} },\n  find_all = true,  -- With this tag, it will return a table of all matching positions within the range, format { {x1, y1}, {x2, y2}, ... }\n})  -- No area parameters means full screen search\n"})}),"\n",(0,t.jsxs)(n.h3,{id:"-capture-screen-content-screenimage",children:["\ud83d\udcf2\ud83c\udf1f Capture Screen Content (",(0,t.jsx)(n.strong,{children:"screen.image"}),")"]}),"\n",(0,t.jsx)(n.h4,{id:"declaration-11",children:"Declaration"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:"screen_content = screen.image([ left, top, right, bottom ])\n"})}),"\n",(0,t.jsx)(n.h4,{id:"parameters-and-return-values-11",children:"Parameters and Return Values"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["left, top, right, bottom","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", ",(0,t.jsx)(n.em,{children:"optional"}),", represents the screen area to capture, default ",(0,t.jsx)(n.strong,{children:"full screen"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["screen_content ",(0,t.jsx)(n.a,{href:"/docs/lua-manual/img#image-object",children:(0,t.jsx)(n.em,{children:"image object"})})]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"description-9",children:"Description"}),"\n",(0,t.jsx)(n.p,{children:"Captures the content of a part of the screen or the entire screen."}),"\n",(0,t.jsx)(n.admonition,{title:"Performance",type:"caution",children:(0,t.jsxs)(n.p,{children:["Generates a new ",(0,t.jsx)(n.em,{children:"image object"}),".\nBe sure to call the ",(0,t.jsx)(n.a,{href:"/docs/lua-manual/img#destroy-an-image-object-imagedestroy",children:(0,t.jsx)(n.code,{children:"image:destroy"})})," method when the object is no longer needed to release its memory."]})}),"\n",(0,t.jsx)(n.h4,{id:"example-10",children:"Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",metastring:'title="screen.image"',children:'screen.image():save_to_album()  -- Capture full screen and save to album\n--\nscreen.image():save_to_png_file("/var/mobile/1.png")  -- Capture full screen and save to file /var/mobile/1.png\n--\nscreen.image(100, 100, 200, 200):save_to_album()  -- Capture the screen area with top-left coordinates at 100, 100 and bottom-right coordinates at 200, 200, and save to album\n--\npasteboard.write(screen.image(100, 100, 200, 200):png_data(), "public.png")  -- Capture the screen area with top-left coordinates at 100, 100 and bottom-right coordinates at 200, 200, and write to clipboard\n'})}),"\n",(0,t.jsxs)(n.h3,{id:"-screen-image-finding-screenfind_image",children:["\ud83d\udcf2 Screen Image Finding (",(0,t.jsx)(n.strong,{children:"screen.find_image"}),")"]}),"\n",(0,t.jsx)(n.h4,{id:"declaration-12",children:"Declaration"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:"x, y, similarity = screen.find_image(sub_image[, similarity, left, top, right, bottom])\n"})}),"\n",(0,t.jsx)(n.h4,{id:"parameters-and-return-values-12",children:"Parameters and Return Values"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["sub_image","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/docs/lua-manual/img#image-object",children:(0,t.jsx)(n.em,{children:"image object"})})}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"path-like string"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Path to the image file to find, if not a valid path, it will be parsed as ",(0,t.jsx)(n.em,{children:"string"})," data"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"string"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Image data to find, can be in ",(0,t.jsx)(n.code,{children:"png"})," or ",(0,t.jsx)(n.code,{children:"jpeg"})," format"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["similarity","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", ",(0,t.jsx)(n.em,{children:"optional"}),", similarity of the sub-image to find, range 1 ~ 100, default ",(0,t.jsx)(n.code,{children:"95"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["left, top, right, bottom","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", ",(0,t.jsx)(n.em,{children:"optional"}),", coordinates of the top-left and bottom-right corners of the search area, default ",(0,t.jsx)(n.strong,{children:"full screen"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["x, y","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", returns the coordinates of the top-left corner of the found sub-image, search failure returns ",(0,t.jsx)(n.code,{children:"-1, -1"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["similarity","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", returns the similarity of the found sub-image to the provided ",(0,t.jsx)(n.strong,{children:"sub_image"}),", range 1 ~ 100, search failure returns ",(0,t.jsx)(n.code,{children:"0"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"description-10",children:"Description"}),"\n",(0,t.jsxs)(n.p,{children:["Finds the position of a ",(0,t.jsx)(n.strong,{children:"sub-image"})," on the screen.\nAdjusts the sub-image with multiple scaling ratios, from 100% to 20%, to improve the success rate of the search."]}),"\n",(0,t.jsx)(n.admonition,{title:"Limitation",type:"caution",children:(0,t.jsx)(n.p,{children:"If multi-resolution compatibility is needed, it is recommended to capture samples on the device with the smallest resolution. Sub-images captured on high-resolution devices may not be found on low-resolution devices."})}),"\n",(0,t.jsx)(n.h4,{id:"example-1-1",children:"Example 1"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",metastring:'title="screen.find_image"',children:'x, y = screen.find_image(  -- Original image position top-left: 354, 274 | bottom-right: 358, 284\n"\\x89\\x50\\x4e\\x47\\x0d\\x0a\\x1a\\x0a\\x00\\x00\\x00\\x0d\\x49\\x48\\x44\\x52\\x00\\x00\\x00\\x04\\x00\\x00\\x00\\x0a\\x08\\x02\\x00\\x00\\x00\\x1c\\x99\\x68\\x59\\x00\\x00\\x00\\x61\\x49\\x44\\x41\\x54\\x78\\xda\\x63\\x78\\xfd\\xf4\\xda\\xff\\xff\\xff\\xff\\xfd\\xfb\\xf7\\xed\\xcb\\x5b\\x86\\xf7\\xaf\\x1f\\xfc\\x87\\x01\\x86\\x2f\\x1f\\x5f\\x02\\xa9\\xef\\xa7\\xce\\x7c\\xdd\\xb1\\x9b\\xe1\\xe7\\xf7\\xcf\\x40\\xce\\xeb\\xb2\\xea\\x7b\\xb2\\x6a\\x0c\\x7f\\xff\\xfe\\x01\\x72\\x9e\\x78\\x06\\x82\\x38\\x20\\xdd\\xbf\\x7e\\xdd\\x57\\xd4\\x82\\x72\\x7e\\xdd\\xba\\x0d\\x64\\x41\\x39\\x08\\xd3\\x80\\x38\\x6b\\xe3\\x7f\\x86\\x2a\\x30\\x02\\x72\\x8c\\xa6\\x40\\x39\\x00\\xd5\\x7b\\x5f\\x2e\\xfd\\xba\\xd5\\x32\\x00\\x00\\x00\\x00\\x49\\x45\\x4e\\x44\\xae\\x42\\x60\\x82", 95, 0, 0, 639, 1135)\n'})}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["In Lua source code, strings starting with ",(0,t.jsx)(n.code,{children:"\\x"})," followed by two hexadecimal digits represent a single byte encoded with that number. For example: ",(0,t.jsx)(n.code,{children:"\\x58"})," represents the character ",(0,t.jsx)(n.code,{children:"X"}),"."]})}),"\n",(0,t.jsx)(n.h4,{id:"example-2-1",children:"Example 2"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",metastring:'title="screen.find_image"',children:'img = image.load_file("/var/mobile/1.png")\nx, y = screen.find_image(img)      -- Find image in full screen range\nx, y = screen.find_image(img, 85)  -- Find image in full screen range, similarity 85%\n'})}),"\n",(0,t.jsx)(n.h4,{id:"example-3-1",children:"Example 3"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",metastring:'title="screen.find_image"',children:'x, y = screen.find_image("/var/mobile/1.png", 95, 0, 0, 639, 1135)  -- Find image in specified area\n'})}),"\n",(0,t.jsx)(n.h4,{id:"example-4-1",children:"Example 4"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",metastring:'title="screen.find_image"',children:'local img = image.load_file("/Applications/MobileSafari.app/AppIcon60x60@2x.png")\nif img then\n  x, y = screen.find_image(img, 80)  -- Find image in full screen range, similarity 80%\n  if x ~= -1 then\n    touch.tap(x, y)\n  else\n    sys.alert("Safari icon not found on the screen")\n  end\nelse\n  sys.alert("Unable to read Safari icon")\nend\n'})}),"\n",(0,t.jsxs)(n.h3,{id:"-screen-optical-character-recognition-screenocr_text",children:["\ud83d\udcf2 Screen Optical Character Recognition (",(0,t.jsx)(n.strong,{children:"screen.ocr_text"}),")"]}),"\n",(0,t.jsx)(n.h4,{id:"declaration-1-1",children:"Declaration 1"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:"text_list, details = screen.ocr_text {\n  left = left, top = top, right = right, bottom = bottom,\n  languages = language_list,\n  words = candidate_words,\n  confidence = min_confidence,\n  level = recognition_level,\n  timeout = timeout\n}\n"})}),"\n",(0,t.jsx)(n.h4,{id:"declaration-2-1",children:"Declaration 2"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:"text_list, details = screen.ocr_text([ recognition_level, timeout ])\n"})}),"\n",(0,t.jsx)(n.h4,{id:"declaration-3-1",children:"Declaration 3"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:"text_list, details = screen.ocr_text(left, top, right, bottom[, recognition_level, timeout])\n"})}),"\n",(0,t.jsx)(n.h4,{id:"parameters-and-return-values-13",children:"Parameters and Return Values"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["left, top, right, bottom","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", ",(0,t.jsx)(n.em,{children:"optional"}),", coordinates of the top-left and bottom-right corners of the recognition area. Default ",(0,t.jsx)(n.strong,{children:"full screen"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["language_list","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"enum"}),", ",(0,t.jsx)(n.em,{children:"optional"}),", list of recognition languages, default ",(0,t.jsx)(n.code,{children:'{ "en-US" }'}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["English ",(0,t.jsx)(n.code,{children:'"en-US"'})]}),"\n",(0,t.jsxs)(n.li,{children:["Simplified Chinese ",(0,t.jsx)(n.code,{children:'"zh-Hans"'})]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["candidate_words","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"list of texts"}),", ",(0,t.jsx)(n.em,{children:"optional"}),", used to improve recognition accuracy. Default ",(0,t.jsx)(n.code,{children:"{ }"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["min_confidence","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", ",(0,t.jsx)(n.em,{children:"optional"}),", minimum confidence of the recognition result, results with confidence lower than this value will be excluded. Range 0.0 ~ 1.0, default ",(0,t.jsx)(n.code,{children:"0.0"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["recognition_level ",(0,t.jsx)(n.em,{children:"enum"}),", ",(0,t.jsx)(n.em,{children:"optional"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"0"})," indicates accurate recognition, more accurate results but slower, default value"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"1"})," indicates fast recognition, less accurate results but faster"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["timeout","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", ",(0,t.jsx)(n.em,{children:"optional"}),", timeout, in milliseconds. Default ",(0,t.jsx)(n.code,{children:"3000"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["text_list","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"list of texts"}),", list of recognized text from top to bottom, returns an empty list if no text is recognized in the specified area"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["details","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"list"}),", each element is an ",(0,t.jsx)(n.em,{children:"associative table"}),", corresponding to the text in ",(0,t.jsx)(n.strong,{children:"text_list"}),", containing the following fields:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"center"})," ",(0,t.jsx)(n.em,{children:"list"}),", coordinates of the center of the recognition result ",(0,t.jsx)(n.code,{children:"{ x, y }"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"bounding_box"})," ",(0,t.jsx)(n.em,{children:"list"}),", bounding box of the recognition result ",(0,t.jsx)(n.code,{children:"{ x1, y1, x2, y2 }"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"confidence"})," ",(0,t.jsx)(n.em,{children:"float"}),", confidence of the recognition result, range 0.0 ~ 1.0"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"recognized_text"})," ",(0,t.jsx)(n.em,{children:"text"}),", recognized text"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",metastring:'title="Details Table Structure"',children:'{\n  [1] = {\n    confidence = 0.5,\n    center = { [1] = 107, [2] = 289 },\n    bounding_box = {\n      [1] = 32,\n      [2] = 276,\n      [3] = 181,\n      [4] = 303,\n    },\n    recognized_text = "Bluetooth",\n  },\n  [2] = {\n    confidence = 1.0,\n    center = { [1] = 337, [2] = 603 },\n    bounding_box = {\n      [1] = 31,\n      [2] = 588,\n      [3] = 644,\n      [4] = 618,\n    },\n    recognized_text = "To pair an Apple Watch with your iPhone, go to the",\n  },\n  ...\n}\n'})}),"\n",(0,t.jsx)(n.h4,{id:"description-11",children:"Description"}),"\n",(0,t.jsxs)(n.p,{children:["Uses Apple\u2019s ",(0,t.jsx)(n.a,{href:"https://developer.apple.com/documentation/vision",children:"Vision"})," framework to perform text recognition on the screen or image, supporting English and Simplified Chinese."]}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsx)(n.p,{children:"In fast recognition mode, the recognition speed is about 10 times faster than accurate recognition, but the results are less accurate and often contain errors."})}),"\n",(0,t.jsxs)(n.h4,{id:"example-screenocr_search",children:["Example ",(0,t.jsx)(n.code,{children:"screen.ocr_search"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",metastring:'title="screen.ocr_search"',children:'screen.ocr_search = function (needle, level)\n  if level == nil then\n    level = 0\n  end\n  local center = nil\n  local _, details = screen.ocr_text(level)\n  for _, v in ipairs(details) do\n    if v["recognized_text"] == needle then\n      center = v["center"]\n      break\n    end\n  end\n  if center == nil then\n    return -1, -1  -- not found\n  end\n  return center[1], center[2]\nend\n'})}),"\n",(0,t.jsxs)(n.h4,{id:"example-screenocr_match",children:["Example ",(0,t.jsx)(n.code,{children:"screen.ocr_match"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",metastring:'title="screen.ocr_match"',children:'screen.ocr_match = function (pattern, level)\n  if level == nil then\n    level = 0\n  end\n  local center = nil\n  local _, details = screen.ocr_text(level)\n  for _, v in ipairs(details) do\n    if string.match(v["recognized_text"], pattern) then\n      center = v["center"]\n      break\n    end\n  end\n  if center == nil then\n    return -1, -1  -- not found\n  end\n  return center[1], center[2]\nend\n'})}),"\n",(0,t.jsxs)(n.h3,{id:"-tesseract-screen-optical-character-recognition-screentess_ocr",children:["\ud83d\udcf2 Tesseract Screen Optical Character Recognition (",(0,t.jsx)(n.strong,{children:"screen.tess_ocr"}),")"]}),"\n",(0,t.jsx)(n.h4,{id:"declaration-1-2",children:"Declaration 1"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:'require("image.tesseract")  -- Needs to be loaded in advance\n--\ntext, details = screen.tess_ocr([{\n  [lang = language,]\n  [white_list = white_list,]\n  [black_list = black_list,]\n  [left   = left,]\n  [top    = top,]\n  [right  = right,]\n  [bottom = bottom,]\n}])\n'})}),"\n",(0,t.jsx)(n.h4,{id:"declaration-2-2",children:"Declaration 2"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:'require("image.tesseract")  -- Needs to be loaded in advance\n--\ntext, details = screen.tess_ocr([ language ])\n'})}),"\n",(0,t.jsx)(n.h4,{id:"parameters-and-return-values-14",children:"Parameters and Return Values"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["language","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"text"}),", ",(0,t.jsx)(n.em,{children:"optional"}),", default ",(0,t.jsx)(n.code,{children:'"eng"'})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["white_list","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"text"}),", ",(0,t.jsx)(n.em,{children:"optional"}),", whitelist of allowed characters"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["black_list","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"text"}),", ",(0,t.jsx)(n.em,{children:"optional"}),", blacklist of filtered characters"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["left, top, right, bottom","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", ",(0,t.jsx)(n.em,{children:"optional"}),", coordinates of the top-left and bottom-right corners of the recognition area, default ",(0,t.jsx)(n.strong,{children:"full screen"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["text ",(0,t.jsx)(n.em,{children:"text"})]}),"\n",(0,t.jsxs)(n.li,{children:["details","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"associative table"}),", position description of each visible character in ",(0,t.jsx)(n.strong,{children:"text"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",metastring:'title="Details Table Structure"',children:'{\n  [1] = {\n    confidence = 96.23314666748,\n    h = 20,\n    x = 64,\n    y = 35,\n    w = 14,\n    text = "7",\n  },\n  [2] = {\n    confidence = 74.24723815918,\n    h = 15,\n    x = 81,\n    y = 38,\n    w = 5,\n    text = "1",\n  },\n  ...\n}\n'})}),"\n",(0,t.jsx)(n.h4,{id:"description-12",children:"Description"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"White List"})," and ",(0,t.jsx)(n.strong,{children:"Black List"})," cannot exist simultaneously, the ",(0,t.jsx)(n.strong,{children:"White List"})," takes precedence."]}),"\n",(0,t.jsxs)(n.li,{children:["Tesseract OCR language files can be obtained from ",(0,t.jsx)(n.a,{href:"https://github.com/tesseract-ocr/tessdata",children:"tesseract-ocr/tessdata"})," or trained by yourself."]}),"\n",(0,t.jsxs)(n.li,{children:["Prepare the language files and import them into the ",(0,t.jsx)(n.code,{children:"/var/mobile/Media/1ferver/tessdata"})," directory on the device to use."]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"example-11",children:"Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",metastring:'title="screen.tess_ocr"',children:'require("image.tesseract")         -- Needs to be loaded in advance\n--\ntext = screen.tess_ocr()           -- Default is "eng", English recognition\n--\ntext = screen.tess_ocr(\'chi_sim\')  -- Simplified Chinese recognition\n--\ntext = screen.tess_ocr {\n  lang = "eng",                  -- English language file\n  white_list = "0123456789",     -- Whitelist\n}\n--\ntext = screen.tess_ocr {\n  lang = "eng",                  -- English language file\n  black_list = "abcdefghijk",    -- Blacklist\n}\n--\ntext = screen.tess_ocr {\n  lang = "chi_sim",              -- Simplified Chinese language file\n  white_list = "0123456789.\u5143",  -- Whitelist\n}\n'})}),"\n",(0,t.jsxs)(n.h3,{id:"-screen-qr-code-recognition-screenqr_decode",children:["\ud83d\udcf2 Screen QR Code Recognition (",(0,t.jsx)(n.strong,{children:"screen.qr_decode"}),")"]}),"\n",(0,t.jsx)(n.h4,{id:"declaration-13",children:"Declaration"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:"text, details = screen.qr_decode([ timeout ])\n"})}),"\n",(0,t.jsx)(n.h4,{id:"parameters-and-return-values-15",children:"Parameters and Return Values"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["timeout","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", ",(0,t.jsx)(n.em,{children:"optional"}),", timeout, in milliseconds. Default ",(0,t.jsx)(n.code,{children:"3000"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["text","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"text"}),", returns ",(0,t.jsx)(n.code,{children:"nil"})," if no QR code is recognized within the timeout"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["details ",(0,t.jsx)(n.em,{children:"associative table"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"center"})," ",(0,t.jsx)(n.em,{children:"list"}),", coordinates of the center of the recognition result on the screen or image ",(0,t.jsx)(n.code,{children:"{ x, y }"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"bounding_box"})," ",(0,t.jsx)(n.em,{children:"list"}),", bounding box of the recognition result on the screen or image ",(0,t.jsx)(n.code,{children:"{ x1, y1, x2, y2 }"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"confidence"})," ",(0,t.jsx)(n.em,{children:"float"}),", confidence of the recognition result, range 0.0 ~ 1.0"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"payload"})," ",(0,t.jsx)(n.em,{children:"text"}),", ",(0,t.jsx)(n.strong,{children:"text"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"description-13",children:"Description"}),"\n",(0,t.jsxs)(n.p,{children:["Uses Apple\u2019s ",(0,t.jsx)(n.a,{href:"https://developer.apple.com/documentation/vision",children:"Vision"})," framework to perform QR code recognition on the screen or image.\nDetects the first complete QR code on the screen or image and decodes it. ",(0,t.jsx)(n.strong,{children:"text"})," is the ",(0,t.jsx)(n.code,{children:"UTF-8"})," text content obtained from decoding the QR code."]}),"\n",(0,t.jsx)(n.h4,{id:"example-decode-a-local-qr-code-image-file",children:"Example: Decode a local QR code image file"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",metastring:'title="image:qr_decode"',children:'local img = image.load_file("/var/mobile/qr.png")\nif img then\n  local str = img:qr_decode()\n  img:destroy()\n  if str then\n    sys.alert("Recognition successful\\nResult: "..str)\n  else\n    sys.alert("Recognition failed")\n  end\nelse\n  sys.alert("Failed to load image file, the file may not exist")\nend\n'})}),"\n",(0,t.jsx)(n.h4,{id:"example-decode-the-qr-code-displayed-on-the-current-screen",children:"Example: Decode the QR code displayed on the current screen"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",metastring:'title="screen.qr_decode"',children:'local str = screen.qr_decode()\nif str then\n  sys.alert("Recognition successful\\nResult: "..str)\nelse\n  sys.alert("Recognition failed")\nend\n'})}),"\n",(0,t.jsxs)(n.h3,{id:"-screen-rectangle-detection-screendetect_rectangles",children:["\ud83d\udcf2 Screen Rectangle Detection (",(0,t.jsx)(n.strong,{children:"screen.detect_rectangles"}),")"]}),"\n",(0,t.jsx)(n.h4,{id:"declaration-1-3",children:"Declaration 1"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:"rectangles, details = screen.detect_rectangles {\n  left = left, top = top, right = right, bottom = bottom,\n  minRatio = min_ratio,\n  maxRatio = max_ratio,\n  minSize = min_size,\n  quadTolerance = max_tilt,\n  confidence = min_confidence,\n  maxCount = max_count,\n  timeout = timeout\n}\n"})}),"\n",(0,t.jsx)(n.h4,{id:"declaration-2-3",children:"Declaration 2"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:"rectangles, details = screen.detect_rectangles([ max_count, timeout ])\n"})}),"\n",(0,t.jsx)(n.h4,{id:"declaration-3-2",children:"Declaration 3"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:"rectangles, details = screen.detect_rectangles(left, top, right, bottom[, max_count, timeout])\n"})}),"\n",(0,t.jsx)(n.h4,{id:"parameters-and-return-values-16",children:"Parameters and Return Values"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["left, top, right, bottom","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", ",(0,t.jsx)(n.em,{children:"optional"}),", coordinates of the top-left and bottom-right corners of the detection area. Default ",(0,t.jsx)(n.strong,{children:"full screen"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["min_ratio, max_ratio","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"float"}),", ",(0,t.jsx)(n.em,{children:"optional"}),", aspect ratio of the detected rectangles, rectangles with aspect ratios outside this range will be excluded. Range 0.0 ~ 1.0, default ",(0,t.jsx)(n.code,{children:"0.1"}),", ",(0,t.jsx)(n.code,{children:"1.0"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["min_size","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"float"}),", ",(0,t.jsx)(n.em,{children:"optional"}),", area ratio of the detected rectangles to the screen or image area, smaller rectangles will be excluded. Range 0.0 ~ 1.0, default ",(0,t.jsx)(n.code,{children:"0.2"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["max_tilt","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"float"}),", ",(0,t.jsx)(n.em,{children:"optional"}),", maximum tilt angle of the detected rectangles, rectangles with tilt angles greater than this value will be excluded. Range 0.0 ~ 45.0, default ",(0,t.jsx)(n.code,{children:"30.0"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["min_confidence","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"float"}),", ",(0,t.jsx)(n.em,{children:"optional"}),", minimum confidence of the detected rectangles, rectangles with confidence lower than this value will be excluded. Range 0.0 ~ 1.0, default ",(0,t.jsx)(n.code,{children:"0.0"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["max_count","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", ",(0,t.jsx)(n.em,{children:"optional"}),", maximum number of rectangles to return. Default ",(0,t.jsx)(n.code,{children:"1"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["timeout","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"integer"}),", ",(0,t.jsx)(n.em,{children:"optional"}),", timeout, in milliseconds. Default ",(0,t.jsx)(n.code,{children:"3000"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["rectangles","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"table"}),", returns a table of rectangle positions, each element is a ",(0,t.jsx)(n.em,{children:"list"})," containing eight ",(0,t.jsx)(n.em,{children:"float"})," elements, corresponding to the four vertices of the detected rectangle, in the order of top-left, top-right, bottom-left, bottom-right"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["details","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.em,{children:"list"}),", each element is an ",(0,t.jsx)(n.em,{children:"associative table"}),", corresponding to the elements in ",(0,t.jsx)(n.strong,{children:"rectangles"}),", containing the following fields:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"center"})," ",(0,t.jsx)(n.em,{children:"list"}),", coordinates of the center of the recognition result on the screen or image ",(0,t.jsx)(n.code,{children:"{ x, y }"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"bounding_box"})," ",(0,t.jsx)(n.em,{children:"list"}),", bounding box of the recognition result on the screen or image ",(0,t.jsx)(n.code,{children:"{ x1, y1, x2, y2 }"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"confidence"})," ",(0,t.jsx)(n.em,{children:"float"}),", confidence of the recognition result, range 0.0 ~ 1.0"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"payload"})," ",(0,t.jsx)(n.em,{children:"list"}),", containing eight ",(0,t.jsx)(n.em,{children:"float"})," elements, corresponding to the four vertices of the detected rectangle, in the order of top-left, top-right, bottom-left, bottom-right"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",metastring:'title="Details Table Structure"',children:"{\n  [1] = {\n    confidence = 1.0,\n    center = { [1] = 372, [2] = 643 },\n    bounding_box = {\n      [1] = 36,\n      [2] = 414,\n      [3] = 708,\n      [4] = 872,\n    },\n    payload = {\n      [1] = 35.81475187093,\n      [2] = 572.14322209358,\n      [3] = 548.85265231133,\n      [4] = 413.79873716831,\n      [5] = 139.88665491343,\n      [6] = 872.24944245815,\n      [7] = 707.94005692005,\n      [8] = 675.78785139322,\n    },\n  },\n  ...\n}\n"})}),"\n",(0,t.jsx)(n.h4,{id:"description-14",children:"Description"}),"\n",(0,t.jsxs)(n.p,{children:["Uses Apple\u2019s ",(0,t.jsx)(n.a,{href:"https://developer.apple.com/documentation/vision",children:"Vision"})," framework to detect quadrilaterals (rectangles with eight degrees of freedom) on the screen or image."]}),"\n",(0,t.jsx)(n.h4,{id:"example-capture-a-card-on-the-screen-and-save-to-album",children:"Example: Capture a card on the screen and save to album"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",metastring:'title="screen.detect_rectangles"',children:"rects, details = screen.detect_rectangles()\nif #rects > 0 then\n  local box = details[1].bounding_box\n  screen.image(box[1], box[2], box[3], box[4]):save_to_album()\nend\n"})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>c});var r=i(6540);const t={},s=r.createContext(t);function l(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);