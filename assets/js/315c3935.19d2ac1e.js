"use strict";(self.webpackChunkxxtouch_lite=self.webpackChunkxxtouch_lite||[]).push([[2491],{793:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"appendix/process-scheduling","title":"Process Scheduling","description":"Each script in XXTouch\xa0Elite runs as an independent process, referred to as a script process. To avoid conflicts and management difficulties caused by multiple script processes running simultaneously, script processes dispatched in the following ways can only have one instance at a time:","source":"@site/docs/appendix/process-scheduling.md","sourceDirName":"appendix","slug":"/appendix/process-scheduling","permalink":"/docs/appendix/process-scheduling","draft":false,"unlisted":false,"editUrl":"https://github.com/OwnGoalStudio/XXTouchElite/tree/main/docs/appendix/process-scheduling.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"appendixSidebar","previous":{"title":"Error Handling","permalink":"/docs/appendix/error-handling"},"next":{"title":"Daemon Mode","permalink":"/docs/appendix/daemon-mode"}}');var i=s(4848),r=s(8453);const l={sidebar_position:5},a="Process Scheduling",o={},c=[{value:"Terminate Script Process",id:"terminate-script-process",level:2},{value:"Restart Script Process",id:"restart-script-process",level:2},{value:"Restart Script (<strong>os.restart</strong>)",id:"restart-script-osrestart",level:3},{value:"Declaration",id:"declaration",level:4},{value:"Parameters and Return Values",id:"parameters-and-return-values",level:4},{value:"Description",id:"description",level:4},{value:"Example 1",id:"example-1",level:4},{value:"Example 2",id:"example-2",level:4},{value:"Dispatch New Process",id:"dispatch-new-process",level:2},{value:"Execute Bash Command (<strong>os.run</strong>)",id:"execute-bash-command-osrun",level:3},{value:"Declaration",id:"declaration-1",level:4},{value:"Parameters and Return Values",id:"parameters-and-return-values-1",level:4},{value:"Description",id:"description-1",level:4},{value:"Example 1: Command Execution",id:"example-1-command-execution",level:4},{value:"Example 2: Command Execution Timeout (Normal Termination)",id:"example-2-command-execution-timeout-normal-termination",level:4},{value:"Example 3: Command Execution Timeout (Unable to Terminate Normally)",id:"example-3-command-execution-timeout-unable-to-terminate-normally",level:4},{value:"Example 4: Execute Another Lua Interpreter (Nesting)",id:"example-4-execute-another-lua-interpreter-nesting",level:4},{value:"Script Termination Callback",id:"script-termination-callback",level:2},{value:"Simple Example",id:"simple-example",level:3},{value:"Complete Encapsulation Example",id:"complete-encapsulation-example",level:3},{value:"Other Functions",id:"other-functions",level:2},{value:"Send Global Notification (<strong>notify_post</strong>)",id:"send-global-notification-notify_post",level:3},{value:"Declaration",id:"declaration-2",level:4},{value:"Parameters and Return Values",id:"parameters-and-return-values-2",level:4},{value:"Description",id:"description-2",level:4},{value:"Lock Process ID File (<strong>lockfile</strong>)",id:"lock-process-id-file-lockfile",level:3},{value:"Declaration",id:"declaration-3",level:4},{value:"Parameters and Return Values",id:"parameters-and-return-values-3",level:4},{value:"Description",id:"description-3",level:4},{value:"Example",id:"example",level:4}];function d(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"process-scheduling",children:"Process Scheduling"})}),"\n",(0,i.jsxs)(n.p,{children:["Each script in XXTouch\xa0Elite runs as an independent process, referred to as a ",(0,i.jsx)(n.strong,{children:"script process"}),". To avoid conflicts and management difficulties caused by multiple script processes running simultaneously, script processes dispatched in the following ways can only have ",(0,i.jsx)(n.strong,{children:"one instance"})," at a time:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Started via volume keys"}),"\n",(0,i.jsxs)(n.li,{children:["Started via ",(0,i.jsx)(n.a,{href:"https://elite.82flex.com/api-283425278",children:"OpenAPI"})," calls"]}),"\n",(0,i.jsxs)(n.li,{children:["Triggered by ",(0,i.jsx)(n.a,{href:"https://cydia.saurik.com/package/libactivator/",children:"Activator"})," events"]}),"\n",(0,i.jsx)(n.li,{children:"Started via the X.X.T.E. application interface"}),"\n",(0,i.jsx)(n.li,{children:"Directly debugged or launched via IDEs like VSCode plugins, XXTStudio, etc."}),"\n",(0,i.jsx)(n.li,{children:"Started remotely via group control software, cloud control software, etc."}),"\n",(0,i.jsxs)(n.li,{children:["Restarted by \u201c",(0,i.jsx)(n.a,{href:"/docs/appendix/daemon-mode",children:"Daemon Mode"}),"\u201d after unexpected termination"]}),"\n",(0,i.jsxs)(n.li,{children:["Started by features like \u201c",(0,i.jsx)(n.a,{href:"https://elite.82flex.com/api-283425313",children:"Startup Script"}),"\u201d or \u201cScheduled Tasks\u201d"]}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["You can use ",(0,i.jsx)(n.code,{children:"utils.launch_args"})," to retrieve the launch arguments of the current script, allowing you to handle different launch methods accordingly."]}),"\n",(0,i.jsxs)(n.li,{children:["Scripts started via command line or the cloud control daemon service ",(0,i.jsx)(n.code,{children:"daemon.lua"})," are not subject to the above restrictions."]}),"\n"]})}),"\n",(0,i.jsx)(n.h2,{id:"terminate-script-process",children:"Terminate Script Process"}),"\n",(0,i.jsx)(n.p,{children:"Script processes can be terminated in the following ways:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://cloudwu.github.io/lua53doc/manual.html#pdf-os.exit",children:(0,i.jsx)(n.code,{children:"os.exit"})})}),"\n",(0,i.jsx)(n.li,{children:"Script execution completion"}),"\n",(0,i.jsx)(n.li,{children:"Stopped via volume keys"}),"\n",(0,i.jsxs)(n.li,{children:["Stopped via ",(0,i.jsx)(n.a,{href:"https://elite.82flex.com/api-283425274",children:"OpenAPI"})," calls"]}),"\n",(0,i.jsxs)(n.li,{children:["Stopped via ",(0,i.jsx)(n.a,{href:"https://cydia.saurik.com/package/libactivator/",children:"Activator"})," events"]}),"\n",(0,i.jsx)(n.li,{children:"Stopped via IDEs like VSCode plugins, XXTStudio, etc."}),"\n",(0,i.jsx)(n.li,{children:"Stopped remotely via group control software, cloud control software, etc."}),"\n",(0,i.jsxs)(n.li,{children:["Sending ",(0,i.jsx)(n.code,{children:"SIGINT"}),", ",(0,i.jsx)(n.code,{children:"SIGTERM"}),", or ",(0,i.jsx)(n.code,{children:"SIGKILL"})," signals to the script process via the command line ",(0,i.jsx)(n.code,{children:"kill"})]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["When a script process terminates, it immediately stops event listeners, closes the UI, terminates all threads and ",(0,i.jsxs)(n.em,{children:["subprocesses (except those ignoring the ",(0,i.jsx)(n.code,{children:"SIGHUP"})," signal)"]})," it has dispatched, and releases all CPU and memory resources occupied by the process group."]}),"\n",(0,i.jsx)(n.h2,{id:"restart-script-process",children:"Restart Script Process"}),"\n",(0,i.jsxs)(n.h3,{id:"restart-script-osrestart",children:["Restart Script (",(0,i.jsx)(n.strong,{children:"os.restart"}),")"]}),"\n",(0,i.jsx)(n.h4,{id:"declaration",children:"Declaration"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"success, failure_reason = os.restart([ script_name ])\n"})}),"\n",(0,i.jsx)(n.h4,{id:"parameters-and-return-values",children:"Parameters and Return Values"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["script_name","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.em,{children:"string"}),", ",(0,i.jsx)(n.em,{children:"optional"}),", a valid script name. Defaults to ",(0,i.jsx)(n.code,{children:'""'})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["success","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.em,{children:"boolean"}),", operation can only fail if a ",(0,i.jsx)(n.strong,{children:"script name"})," is provided; if successful, this function does not return"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["failure_reason ",(0,i.jsx)(n.em,{children:"string"})]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"description",children:"Description"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Terminates the current script process and schedules a reload of the ",(0,i.jsx)(n.strong,{children:"current script file"})," after 2 seconds."]}),"\n",(0,i.jsxs)(n.li,{children:["If a ",(0,i.jsx)(n.strong,{children:"script file"})," is provided, it reloads the script file at the specified path."]}),"\n",(0,i.jsxs)(n.li,{children:["If the operation fails, this function returns ",(0,i.jsx)(n.code,{children:"false"})," along with the failure reason. Common reasons include the provided script file not existing."]}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{type:"caution",children:(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Current script"})," refers to the entry script at startup."]}),"\n",(0,i.jsxs)(n.li,{children:["If the ",(0,i.jsx)(n.strong,{children:"current script"})," is modified, ",(0,i.jsx)(n.code,{children:"os.restart"})," will ",(0,i.jsx)(n.strong,{children:"re-read"})," and run the updated script file from the file system."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Do not"})," use this function in a multithreaded environment. Short-delay restarts may cause other logical issues that you need to handle."]}),"\n"]})}),"\n",(0,i.jsx)(n.h4,{id:"example-1",children:"Example 1"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",metastring:'title="os.restart"',children:'os.restart()  -- Restart to the "current script file"\n'})}),"\n",(0,i.jsx)(n.h4,{id:"example-2",children:"Example 2"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",metastring:'title="os.restart.path"',children:'os.restart("main.lua")  -- Restart to "/var/mobile/Media/1ferver/lua/scripts/main.lua"\n'})}),"\n",(0,i.jsx)(n.h2,{id:"dispatch-new-process",children:"Dispatch New Process"}),"\n",(0,i.jsxs)(n.h3,{id:"execute-bash-command-osrun",children:["Execute Bash Command (",(0,i.jsx)(n.strong,{children:"os.run"}),")"]}),"\n",(0,i.jsx)(n.h4,{id:"declaration-1",children:"Declaration"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"success, reason, exit_code_or_signal, stdout, stderr = os.run(command[, timeout_seconds])\n"})}),"\n",(0,i.jsx)(n.h4,{id:"parameters-and-return-values-1",children:"Parameters and Return Values"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["command ",(0,i.jsx)(n.em,{children:"string"})]}),"\n",(0,i.jsxs)(n.li,{children:["timeout_seconds ",(0,i.jsx)(n.em,{children:"integer"}),", ",(0,i.jsx)(n.em,{children:"optional"})]}),"\n",(0,i.jsxs)(n.li,{children:["success ",(0,i.jsx)(n.em,{children:"boolean"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Returns ",(0,i.jsx)(n.code,{children:"true"})," if successful"]}),"\n",(0,i.jsxs)(n.li,{children:["Returns ",(0,i.jsx)(n.code,{children:"nil"})," instead of ",(0,i.jsx)(n.code,{children:"false"})," if failed"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["reason ",(0,i.jsx)(n.em,{children:"enum"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"exit"}),": Command completed normally; the next number is the ",(0,i.jsx)(n.strong,{children:"exit code"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"signal"}),": Command was interrupted by a signal; the next number is the ",(0,i.jsx)(n.strong,{children:"signal value"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["exit_code_or_signal ",(0,i.jsx)(n.em,{children:"integer"})]}),"\n",(0,i.jsxs)(n.li,{children:["stdout ",(0,i.jsx)(n.em,{children:"string"})]}),"\n",(0,i.jsxs)(n.li,{children:["stderr ",(0,i.jsx)(n.em,{children:"string"})]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"description-1",children:"Description"}),"\n",(0,i.jsxs)(n.p,{children:["This function is similar to ",(0,i.jsx)(n.a,{href:"https://cloudwu.github.io/lua53doc/manual.html#pdf-os.execute",children:(0,i.jsx)(n.code,{children:"os.execute"})})," but adds the following features:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Supports ",(0,i.jsx)(n.strong,{children:"stdout"})," and ",(0,i.jsx)(n.strong,{children:"stderr"})," stream redirection","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Captures the output of the command as return values"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Supports an optional ",(0,i.jsx)(n.strong,{children:"timeout_seconds"})," parameter:","\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["1 second before timeout: Sends a ",(0,i.jsx)(n.code,{children:"SIGTERM"})," signal to the system interpreter"]}),"\n",(0,i.jsxs)(n.li,{children:["On timeout: Sends a ",(0,i.jsx)(n.code,{children:"SIGKILL"})," signal to the system interpreter"]}),"\n",(0,i.jsx)(n.li,{children:"Forcefully closes stdout and stderr streams"}),"\n",(0,i.jsx)(n.li,{children:"Returns the data already retrieved from the streams"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsxs)(n.p,{children:["Refer to ",(0,i.jsx)(n.a,{href:"/docs/appendix/command-line-tools",children:"Command Line Tools"})," to execute another Lua interpreter and set a timeout."]})}),"\n",(0,i.jsx)(n.admonition,{type:"caution",children:(0,i.jsxs)(n.p,{children:["Avoid passing multi-line or overly complex ",(0,i.jsx)(n.strong,{children:"commands"}),"; troubleshooting issues can be very difficult. Write complex Bash/Lua script content to a file first, then execute the file."]})}),"\n",(0,i.jsx)(n.h4,{id:"example-1-command-execution",children:"Example 1: Command Execution"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",metastring:'title="os.run"',children:'os.execute("echo -n aaa")       --\x3e true "exit" 0\n--\n-- Compared to os.execute, os.run returns the output of the command\nos.run("echo -n aaa")           --\x3e true "exit" 0 "aaa" ""\nos.run("sleep 5; echo -n aaa")  --\x3e true "exit" 0 "aaa" ""\n'})}),"\n",(0,i.jsx)(n.h4,{id:"example-2-command-execution-timeout-normal-termination",children:"Example 2: Command Execution Timeout (Normal Termination)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",metastring:'title="os.run.timeout"',children:'--\n-- The first command times out before completion\n-- Sends SIGTERM signal 15 to terminate the system interpreter and its subprocesses\nos.run("sleep 5; echo -n aaa", 3)  --\x3e nil "signal" 15 "" ""\n--\n-- The second command times out before completion\n-- Sends SIGTERM signal 15 to terminate the system interpreter and its subprocesses\n-- Returns the partial output retrieved from the stream before termination\nos.run("echo -n bbb; sleep 5; echo -n aaa", 3)  --\x3e nil "signal" 15 "bbb" ""\n--\n-- Command completes without timeout, returns the full output from the stream\nos.run("echo -n bbb; sleep 5; echo -n aaa", 3)  --\x3e true "exit" 0 "bbbaaa" ""\n'})}),"\n",(0,i.jsx)(n.h4,{id:"example-3-command-execution-timeout-unable-to-terminate-normally",children:"Example 3: Command Execution Timeout (Unable to Terminate Normally)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="trap.sh"',children:'#!/bin/bash\ntrap "" SIGTERM\nexec "$@"\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",metastring:'title="os.run.kill"',children:'--\n-- At the end of the 2nd second, sends SIGTERM signal 15 to the system interpreter, but the signal is ignored\n-- At the end of the 3rd second, sends SIGKILL signal 9 to the system interpreter, forcibly killing the process\nos.run("trap.sh sleep 5", 3)\nnil "signal" 9 "" ""\n'})}),"\n",(0,i.jsx)(n.h4,{id:"example-4-execute-another-lua-interpreter-nesting",children:"Example 4: Execute Another Lua Interpreter (Nesting)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",metastring:'title="os.run.lua"',children:'os.run("lua -e \\"sys.alert(1)\\"", 3)\n'})}),"\n",(0,i.jsx)(n.h2,{id:"script-termination-callback",children:"Script Termination Callback"}),"\n",(0,i.jsx)(n.p,{children:"This is not a function but a method that utilizes Lua\u2019s garbage collection mechanism to execute some code when the script ends (or is terminated)."}),"\n",(0,i.jsx)(n.h3,{id:"simple-example",children:"Simple Example"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'-- Keywords: Script Termination Callback, Script End Callback\nany_variable_name = {}\nsetmetatable(any_variable_name, {\n  __gc = function(...)\n    sys.toast(\'Terminated!\')\n    sys.msleep(500)\n  end\n})\n--\nwhile true do\n  sys.toast("You can try manually terminating the script now\\n\\n"..os.date("%Y-%m-%d %H:%M:%S"))\n  sys.msleep(1000)\nend\n'})}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["Define a global object (table value) and set its ",(0,i.jsx)(n.strong,{children:"destructor"})," to a function. When the Lua virtual machine ends, the ",(0,i.jsx)(n.strong,{children:"destructor"})," of all Lua objects (including the one you defined) will be called. In Lua, a ",(0,i.jsx)(n.strong,{children:"destructor"})," refers to the object\u2019s ",(0,i.jsx)(n.a,{href:"http://cloudwu.github.io/lua53doc/manual.html#2.4",children:"__gc metamethod"}),"."]})}),"\n",(0,i.jsx)(n.h3,{id:"complete-encapsulation-example",children:"Complete Encapsulation Example"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",metastring:'title="atexit.lua" showLineNumbers',children:"function atexit(callback)  -- The parameter is a function. Use atexit(a_function) to register a function to execute when the script ends. Avoid long execution times.\n  ____atexit_guard____ = ____atexit_guard____ or {}\n  if type(____atexit_guard____) == 'table' then\n    if not getmetatable(____atexit_guard____) then\n      setmetatable(____atexit_guard____, {\n        __gc = function(self)\n          if type(self.callback) == 'function' then\n            pcall(self.callback)\n          end\n        end\n      })\n    end\n    ____atexit_guard____.callback = callback\n  else\n    error('Do not name your variable `____atexit_guard____`.')\n  end\nend\n-- The above code can be copied to the beginning of your script. Below is an example of usage.\n--\n-- Use atexit to register a termination callback function\natexit(function()\n  sys.toast('Terminated!')\n  sys.msleep(500)\nend)\n--\nwhile true do\n  sys.toast(\"You can try manually terminating the script now\\n\\n\"..os.date(\"%Y-%m-%d %H:%M:%S\"))\n  sys.msleep(1000)\nend\n"})}),"\n",(0,i.jsx)(n.h2,{id:"other-functions",children:"Other Functions"}),"\n",(0,i.jsxs)(n.h3,{id:"send-global-notification-notify_post",children:["Send Global Notification (",(0,i.jsx)(n.strong,{children:"notify_post"}),")"]}),"\n",(0,i.jsx)(n.h4,{id:"declaration-2",children:"Declaration"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"notify_post(notification_name)\n"})}),"\n",(0,i.jsx)(n.h4,{id:"parameters-and-return-values-2",children:"Parameters and Return Values"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["notification_name ",(0,i.jsx)(n.em,{children:"string"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ch.xxtou.notification.remote-access.on"}),": ",(0,i.jsx)(n.a,{href:"/docs/tutorial/ready-to-develop#enable-remote-access",children:"Enable Remote Access"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ch.xxtou.notification.remote-access.off"}),": Disable Remote Access"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ch.xxtou.notification.restart"}),": Immediately terminate the script and restart the XXTouch\xa0Elite daemon"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ch.xxtou.notification.boom"}),": Immediately terminate the script and uninstall XXTouch\xa0Elite"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"description-2",children:"Description"}),"\n",(0,i.jsxs)(n.p,{children:["Sends a top-level global notification to the Darwin operating system, equivalent to the native ",(0,i.jsx)(n.a,{href:"https://developer.apple.com/documentation/darwinnotify/1433472-notify_post",children:(0,i.jsx)(n.code,{children:"notify_post"})})," function."]}),"\n",(0,i.jsxs)(n.h3,{id:"lock-process-id-file-lockfile",children:["Lock Process ID File (",(0,i.jsx)(n.strong,{children:"lockfile"}),")"]}),"\n",(0,i.jsx)(n.h4,{id:"declaration-3",children:"Declaration"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"success = lockfile(file_path)\n"})}),"\n",(0,i.jsx)(n.h4,{id:"parameters-and-return-values-3",children:"Parameters and Return Values"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["file_path ",(0,i.jsx)(n.em,{children:"string"})]}),"\n",(0,i.jsxs)(n.li,{children:["success ",(0,i.jsx)(n.em,{children:"boolean"})]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"description-3",children:"Description"}),"\n",(0,i.jsxs)(n.p,{children:["Creates or locks the ",(0,i.jsx)(n.strong,{children:"file path"})," and writes the script process\u2019s process ID as text. This is equivalent to a ",(0,i.jsx)(n.a,{href:"https://unix.stackexchange.com/questions/12815/what-are-pid-and-lock-files-for",children:(0,i.jsx)(n.code,{children:"pidfile"})}),", preventing multiple singleton scripts from running simultaneously."]}),"\n",(0,i.jsx)(n.h4,{id:"example",children:"Example"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",metastring:'title="lockfile"',children:'if not lockfile("/tmp/daemon.lua.singleton") then\n  return  -- If the file is already locked by another process, it indicates no need to run again.\nend\n'})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>a});var t=s(6540);const i={},r=t.createContext(i);function l(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);