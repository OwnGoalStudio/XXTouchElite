"use strict";(self.webpackChunkxxtouch_lite=self.webpackChunkxxtouch_lite||[]).push([[2895],{1575:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>l,toc:()=>d});const l=JSON.parse('{"id":"lua-manual/webview","title":"Web View Module","description":"Web View Module - webview","source":"@site/docs/lua-manual/webview.md","sourceDirName":"lua-manual","slug":"/lua-manual/webview","permalink":"/docs/lua-manual/webview","draft":false,"unlisted":false,"editUrl":"https://github.com/OwnGoalStudio/XXTouchElite/tree/main/docs/lua-manual/webview.md","tags":[],"version":"current","sidebarPosition":23,"frontMatter":{"sidebar_position":23},"sidebar":"luaManualSidebar","previous":{"title":"Dialog Module","permalink":"/docs/lua-manual/dialog"},"next":{"title":"VPN Configuration Module","permalink":"/docs/lua-manual/vpnconf"}}');var s=i(4848),t=i(8453);const a={sidebar_position:23},r="Web View Module",o={},d=[{value:"Web View Module - webview",id:"web-view-module---webview",level:2},{value:"Display a Web View (<strong>webview.show</strong>)",id:"display-a-web-view-webviewshow",level:3},{value:"Declaration",id:"declaration",level:4},{value:"Field Description",id:"field-description",level:4},{value:"Description",id:"description",level:4},{value:"Example for this section",id:"example-for-this-section",level:4},{value:"Hide a Web View (<strong>webview.hide</strong>)",id:"hide-a-web-view-webviewhide",level:3},{value:"Declaration",id:"declaration-1",level:4},{value:"Parameters and Return Values",id:"parameters-and-return-values",level:4},{value:"Description",id:"description-1",level:4},{value:"Example for this section",id:"example-for-this-section-1",level:4},{value:"Execute JavaScript on a Web View (<strong>webview.eval</strong>)",id:"execute-javascript-on-a-web-view-webvieweval",level:3},{value:"Declaration",id:"declaration-2",level:4},{value:"Parameters and Return Values",id:"parameters-and-return-values-1",level:4},{value:"Description",id:"description-2",level:4},{value:"Example",id:"example",level:4},{value:"Get the Frame and Level Information of a Web View (<strong>webview.frame</strong>)",id:"get-the-frame-and-level-information-of-a-web-view-webviewframe",level:3},{value:"Declaration",id:"declaration-3",level:4},{value:"Parameters and Return Values",id:"parameters-and-return-values-2",level:4},{value:"Example",id:"example-1",level:4},{value:"Destroy a Web View (<strong>webview.destroy</strong>)",id:"destroy-a-web-view-webviewdestroy",level:3},{value:"Declaration",id:"declaration-4",level:4},{value:"Parameters and Return Values",id:"parameters-and-return-values-3",level:4},{value:"Example for this section",id:"example-for-this-section-2",level:4},{value:"Example Code",id:"example-code",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"web-view-module",children:"Web View Module"})}),"\n",(0,s.jsx)(n.h2,{id:"web-view-module---webview",children:"Web View Module - webview"}),"\n",(0,s.jsxs)(n.h3,{id:"display-a-web-view-webviewshow",children:["Display a Web View (",(0,s.jsx)(n.strong,{children:"webview.show"}),")"]}),"\n",(0,s.jsx)(n.h4,{id:"declaration",children:"Declaration"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"webview.show {  -- All parameters are optional\n  id = view_id,\n  html = html_content,\n  x = origin_x_coordinate,\n  y = origin_y_coordinate,\n  width = width,\n  height = height,\n  corner_radius = corner_radius,\n  alpha = opacity,\n  animation_duration = animation_duration,\n  rotate = rotation_angle,\n  level = window_level,\n  opaque = opaque_range,\n  ignores_hit = ignore_touch_events,\n  can_drag = draggable,\n}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"field-description",children:"Field Description"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["view_id","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.em,{children:"integer"}),", ",(0,s.jsx)(n.em,{children:"optional"}),", different ",(0,s.jsx)(n.strong,{children:"View IDs"})," can be used to display multiple Web Views simultaneously. The range is 1 ~ 1000, default is ",(0,s.jsx)(n.code,{children:"1"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["html_content","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.em,{children:"string"}),", ",(0,s.jsx)(n.em,{children:"optional"}),", defaults to ",(0,s.jsxs)(n.strong,{children:["the content set during the last call to ",(0,s.jsx)(n.code,{children:"webview.show"})]}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["origin_x_coordinate","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.em,{children:"integer"}),", ",(0,s.jsx)(n.em,{children:"optional"}),", distance from the left side of the screen. Default is ",(0,s.jsx)(n.code,{children:"0"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["origin_y_coordinate","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.em,{children:"integer"}),", ",(0,s.jsx)(n.em,{children:"optional"}),", distance from the top of the screen. Default is ",(0,s.jsx)(n.code,{children:"0"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["width","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.em,{children:"integer"}),", ",(0,s.jsx)(n.em,{children:"optional"}),", defaults to ",(0,s.jsx)(n.strong,{children:"screen width"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["height","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.em,{children:"integer"}),", ",(0,s.jsx)(n.em,{children:"optional"}),", defaults to ",(0,s.jsx)(n.strong,{children:"screen height"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["opacity","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.em,{children:"float"}),", ",(0,s.jsx)(n.em,{children:"optional"}),", range is 0.0 ~ 1.0. Default is ",(0,s.jsx)(n.code,{children:"1.0"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["corner_radius","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.em,{children:"float"}),", ",(0,s.jsx)(n.em,{children:"optional"}),", default is ",(0,s.jsx)(n.code,{children:"0.0"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["animation_duration","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.em,{children:"float"}),", ",(0,s.jsx)(n.em,{children:"optional"}),", animation duration from the last state to the current state. Default is ",(0,s.jsx)(n.code,{children:"0.0"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["rotation_angle ",(0,s.jsx)(n.em,{children:"float"}),", ",(0,s.jsx)(n.em,{children:"optional"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Portrait: ",(0,s.jsx)(n.code,{children:"0.0"}),", default value."]}),"\n",(0,s.jsxs)(n.li,{children:["Landscape with Home on the right: ",(0,s.jsx)(n.code,{children:"90.0"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Upside-down portrait: ",(0,s.jsx)(n.code,{children:"180.0"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Landscape with Home on the left: ",(0,s.jsx)(n.code,{children:"270.0"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["window_level","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.em,{children:"float"}),", ",(0,s.jsx)(n.em,{children:"optional"}),", default is ",(0,s.jsx)(n.code,{children:"1100.0"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["opaque_range","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.em,{children:"boolean"}),", ",(0,s.jsx)(n.em,{children:"optional"}),", default is ",(0,s.jsx)(n.code,{children:"true"}),", meaning the background is opaque."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["ignore_touch_events","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.em,{children:"boolean"}),", ",(0,s.jsx)(n.em,{children:"optional"}),", default is ",(0,s.jsx)(n.code,{children:"false"}),", meaning touch events are not ignored. This property cannot be changed after the Web View is created."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["draggable","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.em,{children:"boolean"}),", ",(0,s.jsx)(n.em,{children:"optional"}),", default is ",(0,s.jsx)(n.code,{children:"false"}),", meaning it cannot be dragged."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"description",children:"Description"}),"\n",(0,s.jsx)(n.p,{children:"Displays a Web View on the screen with the specified parameters. If the Web View is already displayed, its parameters will be updated."}),"\n",(0,s.jsx)(n.h4,{id:"example-for-this-section",children:(0,s.jsx)(n.a,{href:"#example-code",children:"Example for this section"})}),"\n",(0,s.jsxs)(n.h3,{id:"hide-a-web-view-webviewhide",children:["Hide a Web View (",(0,s.jsx)(n.strong,{children:"webview.hide"}),")"]}),"\n",(0,s.jsx)(n.h4,{id:"declaration-1",children:"Declaration"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"webview.hide([ view_id ])\n"})}),"\n",(0,s.jsx)(n.h4,{id:"parameters-and-return-values",children:"Parameters and Return Values"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["View ID","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.em,{children:"integer"}),", ",(0,s.jsx)(n.em,{children:"optional"}),", default is ",(0,s.jsx)(n.code,{children:"1"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"description-1",children:"Description"}),"\n",(0,s.jsx)(n.p,{children:"Temporarily hides a Web View."}),"\n",(0,s.jsx)(n.h4,{id:"example-for-this-section-1",children:(0,s.jsx)(n.a,{href:"#example-code",children:"Example for this section"})}),"\n",(0,s.jsxs)(n.h3,{id:"execute-javascript-on-a-web-view-webvieweval",children:["Execute JavaScript on a Web View (",(0,s.jsx)(n.strong,{children:"webview.eval"}),")"]}),"\n",(0,s.jsx)(n.h4,{id:"declaration-2",children:"Declaration"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"result_text = webview.eval(js_text[, view_id])\n"})}),"\n",(0,s.jsx)(n.h4,{id:"parameters-and-return-values-1",children:"Parameters and Return Values"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["JS Text","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.em,{children:"string"}),", JavaScript code to execute."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["View ID","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.em,{children:"integer"}),", ",(0,s.jsx)(n.em,{children:"optional"}),", default is ",(0,s.jsx)(n.code,{children:"1"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Result Text","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.em,{children:"string"}),", returns the result of the executed code."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"description-2",children:"Description"}),"\n",(0,s.jsx)(n.p,{children:"Executes a JavaScript snippet on a Web View and retrieves the result as text."}),"\n",(0,s.jsx)(n.h4,{id:"example",children:"Example"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",metastring:'title="webview.eval"',children:'r = webview.eval("a = 3; b = 2; a * b;")\n'})}),"\n",(0,s.jsxs)(n.h3,{id:"get-the-frame-and-level-information-of-a-web-view-webviewframe",children:["Get the Frame and Level Information of a Web View (",(0,s.jsx)(n.strong,{children:"webview.frame"}),")"]}),"\n",(0,s.jsx)(n.h4,{id:"declaration-3",children:"Declaration"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"frame_info = webview.frame([ view_id ])\n"})}),"\n",(0,s.jsx)(n.h4,{id:"parameters-and-return-values-2",children:"Parameters and Return Values"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["view_id","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.em,{children:"integer"}),", ",(0,s.jsx)(n.em,{children:"optional"}),", default is ",(0,s.jsx)(n.code,{children:"1"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["frame_info ",(0,s.jsx)(n.em,{children:"associative table"})]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"example-1",children:"Example"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",metastring:'title="webview.frame"',children:'local frame = webview.frame()\nsys.alert(\n  "Position: " .. "(" .. frame.x .. "," .. frame.y .. ")\\n" ..\n  "Size: " .. "(w: " .. frame.width .. ", h: " .. frame.height .. ")\\n" ..\n  "Level: " .. "(" .. frame.level .. ")"\n)\n'})}),"\n",(0,s.jsxs)(n.h3,{id:"destroy-a-web-view-webviewdestroy",children:["Destroy a Web View (",(0,s.jsx)(n.strong,{children:"webview.destroy"}),")"]}),"\n",(0,s.jsx)(n.h4,{id:"declaration-4",children:"Declaration"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"webview.destroy([ view_id ])\n"})}),"\n",(0,s.jsx)(n.h4,{id:"parameters-and-return-values-3",children:"Parameters and Return Values"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["view_id","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.em,{children:"integer"}),", ",(0,s.jsx)(n.em,{children:"optional"}),", default is ",(0,s.jsx)(n.code,{children:"1"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsx)(n.p,{children:"When the script ends, all displayed Web Views will be automatically destroyed."})}),"\n",(0,s.jsx)(n.h4,{id:"example-for-this-section-2",children:(0,s.jsx)(n.a,{href:"#example-code",children:"Example for this section"})}),"\n",(0,s.jsx)(n.h2,{id:"example-code",children:"Example Code"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",metastring:'title="webview.demo"',children:'local html = [==[\n<!DOCTYPE html>\n<html>\n  <head>\n    <script src="/js/jquery.min.js"><\/script>\n    <script src="/js/jquery.json.min.js"><\/script>\n    <script type="text/javascript">\n      $(document).ready(function() {\n        $("#toast_content").val("Toast Content");\n        $("#close_page").click(function() {\n          $.post("/proc_queue_push", \'{"key": "Message from Web View","value": "Close Page"}\', function() {});\n        });\n        $("#show_toast").click(function() {\n          $.post("/proc_put", $.toJSON({\n            key: "Toast Content",\n            value: $("#toast_content").val()\n          }), function() {});\n          $.post("/proc_queue_push", \'{"key": "Message from Web View","value": "Show Toast"}\', function() {});\n        });\n        $("#slide_down").click(function() {\n          $.post("/proc_queue_push", \'{"key": "Message from Web View","value": "Slide Down"}\', function() {});\n          $(this).hide();\n        });\n        $("#full_vertical").click(function() {\n          $.post("/proc_queue_push", \'{"key": "Message from Web View","value": "Full Vertical"}\', function() {});\n        });\n        $("#full_landscape").click(function() {\n          $.post("/proc_queue_push", \'{"key": "Message from Web View","value": "Full Landscape"}\', function() {});\n        });\n      });\n    <\/script>\n  </head>\n  <body>\n    <p>Dynamic Web View Demo</p>\n    <p>\n      <button id="close_page" type="button">Click to Close Page</button>\n    </p>\n    <p>\n      <button id="show_toast" type="button">Show a Toast</button>\n      <input type="text" id="toast_content" />\n    </p>\n    <p>\n      <button id="full_vertical" type="button">Full Vertical</button>\n      <button id="full_landscape" type="button">Full Landscape</button>\n    </p>\n    <p>\n      <button id="slide_down" type="button">Slide View Down</button>\n    </p>\n    <select>\n      <option value="o1">Option 1</option>\n      <option value="o2">Option 2</option>\n      <option value="o3">Option 3</option>\n      <option value="o4">Option 4</option>\n    </select>\n  </body>\n</html>\n]==]\n--\nlocal w, h = screen.size()\n--\nlocal factor = 1  -- Default height for 2x devices\nif w == 1242 or w == 1080 then\n  factor = 1.5    -- iPhone 6S Plus resolution is 3x\nelseif w == 320 or w == 768 then\n  factor = 0.5    -- Pre-iPhone 3Gs resolution is 1x\nend\n--\nwebview.show {    -- Reset Web View position to top-left corner\n  x = 0,\n  y = 0,\n  width = w - 40 * factor,\n  height = (500) * factor,\n  alpha = 0,\n  animation_duration = 0,\n}\n--\nwebview.show {    -- Slide out from top-left corner in 0.3 seconds\n  html = html,\n  x = 20 * factor,\n  y = 50 * factor,\n  width = (w - 40 * factor),\n  height = (500) * factor,\n  corner_radius = 10,\n  alpha = 0.7,\n  animation_duration = 0.3,\n}\n--\nproc.queue_clear("Message from Web View", "")  -- Clear dictionary values to listen for\nlocal eid = thread.register_event(            -- Register event to listen for dictionary state changes\n  "Message from Web View",\n  function(val)\n    if val == "Close Page" then\n      webview.show {\n        x = 20 * factor,\n        y = 500 * factor * 2,\n        width = (w - 40 * factor),\n        height = (500 - 70) * factor,\n        corner_radius = 10,\n        alpha = 0,\n        animation_duration = 0.8,\n      }\n      sys.msleep(800)\n      webview.destroy()\n      sys.toast("Page thread ended")\n      return true                              -- Return true to stop current listener\n    elseif val == "Slide Down" then\n      webview.show {\n        x = 20 * factor,\n        y = (50 + 300) * factor,               -- Y coordinate + 300\n        width = (w - 40  * factor),\n        height = (500 - 70) * factor,          -- Adjust height as slide down button is hidden\n        corner_radius = 10,\n        alpha = 0.7,\n        animation_duration = 0.5,              -- Duration 0.5 seconds\n      }\n    elseif val == "Full Vertical" then\n      webview.show {}                          -- Set Web View to full screen\n    elseif val == "Full Landscape" then\n      webview.show { rotate = 90 }             -- Set Web View to full landscape\n    elseif val == "Show Toast" then\n      sys.toast(proc.get("Toast Content"))\n    end\n  end\n)\n--\nsys.msleep(3000)\nsys.toast("Main thread ended")\n'})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>r});var l=i(6540);const s={},t=l.createContext(s);function a(e){const n=l.useContext(t);return l.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),l.createElement(t.Provider,{value:n},e.children)}}}]);