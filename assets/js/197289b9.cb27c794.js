"use strict";(self.webpackChunkxxtouch_lite=self.webpackChunkxxtouch_lite||[]).push([[4400],{4339:(e,n,l)=>{l.r(n),l.d(n,{assets:()=>i,contentTitle:()=>d,default:()=>u,frontMatter:()=>t,metadata:()=>s,toc:()=>r});const s=JSON.parse('{"id":"lua-manual/json","title":"JSON Module","description":"JSON Module - json","source":"@site/docs/lua-manual/json.md","sourceDirName":"lua-manual","slug":"/lua-manual/json","permalink":"/docs/lua-manual/json","draft":false,"unlisted":false,"editUrl":"https://github.com/OwnGoalStudio/XXTouchElite/tree/main/docs/lua-manual/json.md","tags":[],"version":"current","sidebarPosition":12,"frontMatter":{"sidebar_position":12},"sidebar":"luaManualSidebar","previous":{"title":"Extended String Module","permalink":"/docs/lua-manual/exstring"},"next":{"title":"Property List Module","permalink":"/docs/lua-manual/plist"}}');var a=l(4848),o=l(8453);const t={sidebar_position:12},d="JSON Module",i={},r=[{value:"JSON Module - json",id:"json-module---json",level:2},{value:"Dump Lua values to JSON text (<strong>json.encode</strong>)",id:"dump-lua-values-to-json-text-jsonencode",level:3},{value:"Declaration",id:"declaration",level:4},{value:"Parameters and Return Values",id:"parameters-and-return-values",level:4},{value:"Example",id:"example",level:4},{value:"Load JSON text as Lua values (<strong>json.decode</strong>)",id:"load-json-text-as-lua-values-jsondecode",level:3},{value:"Declaration",id:"declaration-1",level:4},{value:"Parameters and Return Values",id:"parameters-and-return-values-1",level:4},{value:"Example",id:"example-1",level:4},{value:"NULL constant in JSON (<strong>json.null</strong>)",id:"null-constant-in-json-jsonnull",level:3},{value:"Declaration",id:"declaration-2",level:4},{value:"Description",id:"description",level:4},{value:"Example",id:"example-2",level:4}];function c(e){const n={admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"json-module",children:"JSON Module"})}),"\n",(0,a.jsx)(n.h2,{id:"json-module---json",children:"JSON Module - json"}),"\n",(0,a.jsxs)(n.h3,{id:"dump-lua-values-to-json-text-jsonencode",children:["Dump Lua values to JSON text (",(0,a.jsx)(n.strong,{children:"json.encode"}),")"]}),"\n",(0,a.jsx)(n.h4,{id:"declaration",children:"Declaration"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:"json_text = json.encode(value)\n"})}),"\n",(0,a.jsx)(n.h4,{id:"parameters-and-return-values",children:"Parameters and Return Values"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["value ",(0,a.jsx)(n.em,{children:"any"})," or ",(0,a.jsx)(n.code,{children:"json.null"})]}),"\n",(0,a.jsxs)(n.li,{children:["json_text","\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.em,{children:"string"}),", returns ",(0,a.jsx)(n.code,{children:"nil"})," if conversion fails"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.admonition,{title:"Limitations",type:"caution",children:(0,a.jsx)(n.p,{children:"Not all Lua values can be converted to JSON, such as userdata, functions, and tables containing userdata or functions. These values will be ignored during conversion."})}),"\n",(0,a.jsx)(n.h4,{id:"example",children:"Example"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",metastring:'title="json.encode"',children:'local tb = {\n  ["\u819c"] = "\u56fe\u6837\u56fe\u68ee\u7834\u6851\u53f9\u65af\u4e43\u8863\u670d",\n  ["\u86e4"] = "\u6bd4\u4f60\u4eec\u9ad8\u5230\u4e0d\u77e5\u9053\u54ea\u91cc\u53bb\u4e86",\n  moha = {\n      1,0,0,4,6,9,5,1,0,0,\n  },\n  nullvalue = json.null,\n}\n--\nlocal jsonstr = json.encode(tb)\nsys.alert(jsonstr)\n--\nlocal tmp = json.decode(jsonstr)\nsys.alert(tmp.moha[5])\nsys.alert(tostring(tmp.nullvalue))\n'})}),"\n",(0,a.jsxs)(n.h3,{id:"load-json-text-as-lua-values-jsondecode",children:["Load JSON text as Lua values (",(0,a.jsx)(n.strong,{children:"json.decode"}),")"]}),"\n",(0,a.jsx)(n.h4,{id:"declaration-1",children:"Declaration"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:"value = json.decode(json_text)\n"})}),"\n",(0,a.jsx)(n.h4,{id:"parameters-and-return-values-1",children:"Parameters and Return Values"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["json_text ",(0,a.jsx)(n.em,{children:"string"})]}),"\n",(0,a.jsxs)(n.li,{children:["value","\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.em,{children:"any"})," or ",(0,a.jsx)(n.code,{children:"json.null"}),", returns ",(0,a.jsx)(n.code,{children:"nil"})," if conversion fails"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h4,{id:"example-1",children:"Example"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",metastring:'title="json.decode"',children:"nLog(json.decode('true'))\nnLog(json.decode('17'))\nnLog(json.decode('\"\u54c8\u54c8\"'))\nnLog(json.decode('null'))\nnLog(json.decode(''))\n--\ntable.deep_print(json.decode('{}'))\ntable.deep_print(json.decode('{\"\u5a18\u5b50\":\"\u554a\u54c8\",\"\u4f60\u597d\":\"\u4e16\u754c\"}'))\ntable.deep_print(json.decode('[]'))\ntable.deep_print(json.decode('[1, 0, 0, \"4695100\"]'))\n--\nsys.alert(print.out())\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:'-- Use json.decode to convert Unicode encoding to text\nsys.alert(json.decode([["\\u82cf\\u6cfd"]]))\n'})}),"\n",(0,a.jsxs)(n.h3,{id:"null-constant-in-json-jsonnull",children:["NULL constant in JSON (",(0,a.jsx)(n.strong,{children:"json.null"}),")"]}),"\n",(0,a.jsx)(n.h4,{id:"declaration-2",children:"Declaration"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:"json.null\n"})}),"\n",(0,a.jsx)(n.h4,{id:"description",children:"Description"}),"\n",(0,a.jsxs)(n.p,{children:["This is not a function but a constant. When printed as text, it appears as ",(0,a.jsx)(n.code,{children:'"userdata: 0x0"'}),". It is used to represent the ",(0,a.jsx)(n.code,{children:"null"})," value in JSON."]}),"\n",(0,a.jsx)(n.admonition,{title:"Why is it necessary?",type:"note",children:(0,a.jsxs)(n.p,{children:["Because ",(0,a.jsx)(n.code,{children:"nil"})," in Lua tables is treated as non-existent, the key will disappear after being converted to JSON. Therefore, a specific value is needed to represent this ",(0,a.jsx)(n.code,{children:"null"}),"."]})}),"\n",(0,a.jsx)(n.h4,{id:"example-2",children:"Example"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",metastring:'title="json.null"',children:"local tb = json.decode('{\"nullvalue\":null}')\nif tb['nullvalue'] == json.null then\n  sys.alert(json.null)\nend\n"})})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},8453:(e,n,l)=>{l.d(n,{R:()=>t,x:()=>d});var s=l(6540);const a={},o=s.createContext(a);function t(e){const n=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:t(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);