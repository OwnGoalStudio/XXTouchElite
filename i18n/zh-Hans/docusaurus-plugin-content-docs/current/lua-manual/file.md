---
sidebar_position: 18
---

# æ–‡ä»¶æ“ä½œæ¨¡å—

## æ–‡ä»¶æ“ä½œæ¨¡å— - file

æ ‡æœ‰ ğŸ”¤ çš„å‡½æ•°å°†è¯»å…¥çš„æ–‡ä»¶ä½œä¸º UTF-8 æ–‡æœ¬æ–‡ä»¶è¿›è¡Œå¤„ç†ã€‚

### åˆ¤æ–­æ–‡ä»¶æˆ–ç›®å½•æ˜¯å¦å­˜åœ¨ \(**file\.exists**\)

#### å£°æ˜

```lua
å­˜åœ¨ä¿¡æ¯ = file.exists(æ–‡ä»¶æˆ–ç›®å½•è·¯å¾„)
```

#### å‚æ•°åŠè¿”å›å€¼

- æ–‡ä»¶æˆ–ç›®å½•è·¯å¾„ *æ–‡æœ¬å‹*
- å­˜åœ¨ä¿¡æ¯
  - `false` æˆ– `"file"` æˆ– `"directory"`
    - `false` è·¯å¾„ä¸å­˜åœ¨
    - `"file"` è·¯å¾„æ˜¯ä¸€ä¸ªæ–‡ä»¶
    - `"directory"` è·¯å¾„æ˜¯ä¸€ä¸ªç›®å½•

#### ç¤ºä¾‹

```lua title="file.exists"
if file.exists("/var/mobile/1.zip") then
  sys.alert("`/var/mobile/1.zip` å­˜åœ¨")
else
  sys.alert("`/var/mobile/1.zip` ä¸å­˜åœ¨")
end
--
if file.exists("/var/mobile/1.zip") == "file" then
  sys.alert("`/var/mobile/1.zip` å­˜åœ¨å¹¶ä¸”æ˜¯ä¸ªæ–‡ä»¶")
else
  sys.alert("`/var/mobile/1.zip` ä¸æ˜¯æ–‡ä»¶")
end
--
if file.exists("/var/mobile/123/") == "directory" then
  sys.alert("`/var/mobile/123/` å­˜åœ¨å¹¶ä¸”æ˜¯ä¸ªç›®å½•")
else
  sys.alert("`/var/mobile/123/` ä¸æ˜¯ç›®å½•")
end
```

### åˆ—å‡ºç›®å½•å†…æ‰€æœ‰æ–‡ä»¶å \(**file\.list**\)

#### å£°æ˜

```lua
æ–‡ä»¶åˆ—è¡¨ = file.list(ç›®å½•è·¯å¾„)
```

#### å‚æ•°åŠè¿”å›å€¼

- ç›®å½•è·¯å¾„ *æ–‡æœ¬å‹*
- æ–‡ä»¶åˆ—è¡¨
  - *æ–‡æœ¬å‹é¡ºåºè¡¨*ï¼Œå¦‚æœç›®å½•ä¸å­˜åœ¨æˆ–æŒ‡å®šè·¯å¾„æ˜¯ä¸€ä¸ªæ–‡ä»¶åˆ™è¿”å› `nil`

#### ç¤ºä¾‹

```lua title="file.list"
local list = file.list("/var/mobile/")
if list then
  nLog("ç›®å½• `/var/mobile/` ä¸­æœ‰" .. #list .. "ä¸ªæ–‡ä»¶æˆ–ç›®å½•")
  for _, name in ipairs(list) do
    nLog(name)
  end
  sys.alert(print.out())
else
  sys.alert("`/var/mobile/` ä¸æ˜¯ç›®å½•")
end
```

### è·å¾—æ–‡ä»¶çš„å°ºå¯¸ \(**file\.size**\)

#### å£°æ˜

```lua
æ–‡ä»¶å°ºå¯¸ = file.size(æ–‡ä»¶è·¯å¾„)
```

#### å‚æ•°åŠè¿”å›å€¼

- æ–‡ä»¶è·¯å¾„ *æ–‡æœ¬å‹*
- æ–‡ä»¶å°ºå¯¸
  - *æ•´æ•°å‹*ï¼Œå•ä½ä¸ºå­—èŠ‚ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨æˆ–æŒ‡å®šè·¯å¾„æ˜¯ä¸€ä¸ªç›®å½•åˆ™è¿”å› `nil`

#### ç¤ºä¾‹

```lua title="file.size"
local fsize = file.size("/var/mobile/1.zip")
if fsize then
  sys.alert("`/var/mobile/1.zip` çš„å°ºå¯¸ä¸ºï¼š" .. fsize .. "å­—èŠ‚")
else
  sys.alert("`/var/mobile/1.zip` ä¸æ˜¯æ–‡ä»¶")
end
```

### è¯»å–æ–‡ä»¶ä¸­çš„æ•°æ® \(**file\.reads**\)

#### å£°æ˜

```lua
æ–‡ä»¶å†…å®¹ = file.reads(æ–‡ä»¶è·¯å¾„)
```

#### å‚æ•°åŠè¿”å›å€¼

- æ–‡ä»¶è·¯å¾„ *æ–‡æœ¬å‹*
- æ–‡ä»¶å†…å®¹
  - *å­—ç¬¦ä¸²å‹*ï¼Œæ•´ä¸ªæ–‡ä»¶çš„æ•°æ®å†…å®¹ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨æˆ–æŒ‡å®šè·¯å¾„æ˜¯ä¸€ä¸ªç›®å½•åˆ™è¿”å› `nil`

#### ç¤ºä¾‹

```lua title="file.reads"
local data = file.reads("/var/mobile/1.zip")
if data then
  sys.alert("`/var/mobile/1.zip` çš„å°ºå¯¸ä¸ºï¼š" .. #data .. "å­—èŠ‚")
else
  sys.alert("`/var/mobile/1.zip` ä¸æ˜¯æ–‡ä»¶")
end
```

### å°†æ•°æ®å†™å…¥åˆ°æ–‡ä»¶ \(**file\.writes**\)

#### å£°æ˜

```lua
æ“ä½œæˆè´¥ = file.writes(æ–‡ä»¶è·¯å¾„, å¾…å†™å…¥å†…å®¹)
```

#### å‚æ•°åŠè¿”å›å€¼

- æ–‡ä»¶è·¯å¾„ *æ–‡æœ¬å‹*
- å¾…å†™å…¥å†…å®¹ *å­—ç¬¦ä¸²å‹*
- æ“ä½œæˆè´¥ *å¸ƒå°”å‹*

#### è¯´æ˜

å°†æ•°æ®è¦†ç›–å†™å…¥åˆ° **æ–‡ä»¶è·¯å¾„**ï¼Œæ–‡ä»¶ä¸å­˜åœ¨ä¼šåˆ›å»ºæ–‡ä»¶ï¼ŒæŒ‡å®šè·¯å¾„çš„ä¸Šçº§ç›®å½•ä¸å­˜åœ¨åˆ™ä¼šè¿”å› `false`ã€‚

#### ç¤ºä¾‹

```lua title="file.writes"
local success = file.writes("/var/mobile/1.txt", "è‹Ÿ")
if success then
  sys.alert("å†™å…¥æˆåŠŸ")
else
  sys.alert("å†™å…¥å¤±è´¥")
end
```

### å°†æ•°æ®è¿½åŠ åˆ°æ–‡ä»¶æœ«å°¾ \(**file\.appends**\)

#### å£°æ˜

```lua
æ“ä½œæˆè´¥ = file.appends(æ–‡ä»¶è·¯å¾„, å¾…è¿½åŠ å†…å®¹)
```

#### å‚æ•°åŠè¿”å›å€¼

- æ–‡ä»¶è·¯å¾„ *æ–‡æœ¬å‹*
- å¾…è¿½åŠ å†…å®¹ *å­—ç¬¦ä¸²å‹*
- æ“ä½œæˆè´¥ *å¸ƒå°”å‹*

#### è¯´æ˜

å°† **å¾…è¿½åŠ å†…å®¹** è¿½åŠ åˆ°æ–‡ä»¶æœ«å°¾ï¼Œæ–‡ä»¶ä¸å­˜åœ¨ä¼šåˆ›å»ºæ–‡ä»¶ï¼ŒæŒ‡å®šè·¯å¾„çš„ä¸Šçº§ç›®å½•ä¸å­˜åœ¨åˆ™ä¼šè¿”å› `false`ã€‚

#### ç¤ºä¾‹

```lua title="file.appends"
local success = file.appends("/var/mobile/1.txt", "åˆ©å›½å®¶ç”Ÿæ­»çŸ£")
if success then
  sys.alert("å†™å…¥æˆåŠŸ")
else
  sys.alert("å†™å…¥å¤±è´¥")
end
```

### ğŸ”¤ ç»Ÿè®¡æ–‡æœ¬æ–‡ä»¶çš„æ€»è¡Œæ•° \(**file\.line\_count**\)

#### å£°æ˜

```lua
è¡Œæ•° = file.line_count(æ–‡ä»¶è·¯å¾„)
```

#### å‚æ•°åŠè¿”å›å€¼

- æ–‡ä»¶è·¯å¾„ *æ–‡æœ¬å‹*
- è¡Œæ•°
  - *æ•´æ•°å‹*ï¼Œç©ºæ–‡ä»¶å°†è¿”å› `1`ï¼Œæ–‡ä»¶ä¸å­˜åœ¨è¿”å› `nil`

#### ç¤ºä¾‹

```lua title="file.line_count"
local cnt = file.line_count("/var/mobile/1.txt")
if cnt then
  sys.alert("`/var/mobile/1.txt` ä¸€å…±æœ‰ " .. cnt .. " è¡Œ")
else
  sys.alert("`/var/mobile/1.txt` ä¸æ˜¯æ–‡ä»¶")
end
```

### ğŸ”¤ è·å–æ–‡æœ¬æ–‡ä»¶æŒ‡å®šè¡Œçš„å†…å®¹ \(**file\.get\_line**\)

#### å£°æ˜

```lua
è¡Œå†…å®¹ = file.get_line(æ–‡ä»¶è·¯å¾„, è¡Œå·)
```

#### å‚æ•°åŠè¿”å›å€¼

- æ–‡ä»¶è·¯å¾„ *æ–‡æœ¬å‹*
- è¡Œå·
  - *æ•´æ•°å‹*ï¼Œä¼ å…¥æ­£æ•´æ•°ä»¥æŒ‡å®šè¡Œå·ï¼Œä¼ å…¥ `0` æ— æ•ˆï¼Œè´Ÿæ•°åˆ™ä¸ºå€’æ•°è¡Œå·
- è¡Œå†…å®¹
  - *æ–‡æœ¬å‹*ï¼Œæ“ä½œå¤±è´¥è¿”å› `nil`

#### è¯´æ˜

è¡Œå·ä» `1` å¼€å§‹ï¼Œå¦‚æœè¡Œå·è¶…å‡ºèŒƒå›´æˆ–æ–‡ä»¶ä¸å­˜åœ¨åˆ™è¿”å› `nil`ã€‚

#### ç¤ºä¾‹

```lua title="file.get_line"
local data = file.get_line("/var/mobile/1.txt", 1)
if data then
  data = string.strip_utf8_bom(data) -- å¤„ç†æ‰å¯èƒ½å­˜åœ¨çš„ UTF8-BOM
  sys.alert("`/var/mobile/1.txt` ç¬¬ä¸€è¡Œçš„å†…å®¹æ˜¯ " .. data)
else
  sys.alert("`/var/mobile/1.txt` ä¸æ˜¯æ–‡ä»¶")
end
```

### ğŸ”¤ è®¾ç½®æ–‡æœ¬æ–‡ä»¶æŒ‡å®šè¡Œçš„å†…å®¹ \(**file\.set\_line**\)

#### å£°æ˜

```lua
æ“ä½œæˆè´¥ = file.set_line(æ–‡ä»¶è·¯å¾„, è¡Œå·, å¾…å†™å…¥å†…å®¹)
```

#### å‚æ•°åŠè¿”å›å€¼

- æ–‡ä»¶è·¯å¾„ *æ–‡æœ¬å‹*
- è¡Œå·
  - *æ•´æ•°å‹*ï¼Œä¼ å…¥æ­£æ•´æ•°ä»¥æŒ‡å®šè¡Œå·ï¼Œ`0` ä¸ºæœ€åä¸€è¡Œ + 1ï¼Œè´Ÿæ•°åˆ™ä¸ºå€’æ•°è¡Œå·
- å¾…å†™å…¥å†…å®¹ *æ–‡æœ¬å‹*
- æ“ä½œæˆè´¥ *å¸ƒå°”å‹*

#### è¯´æ˜

è®¾ç½®æ–‡æœ¬æ–‡ä»¶æŒ‡å®šè¡Œçš„å†…å®¹ï¼Œè¡Œæ•°ä¸å¤Ÿç”¨ç©ºè¡Œè¡¥è¶³ï¼Œæ–‡ä»¶ä¸å­˜åœ¨ä¼šåˆ›å»ºæ–‡ä»¶ï¼ŒæŒ‡å®šè·¯å¾„çš„ä¸Šçº§ç›®å½•ä¸å­˜åœ¨åˆ™ä¼šè¿”å› `false`ã€‚

#### ç¤ºä¾‹

```lua title="file.set_line"
local success = file.set_line("/var/mobile/1.txt", 3, "å“ˆå“ˆå“ˆ")
if success then
  sys.alert("æ“ä½œæˆåŠŸ")
else
  sys.alert("æ“ä½œå¤±è´¥")
end
```

### ğŸ”¤ åœ¨æ–‡æœ¬æ–‡ä»¶æŒ‡å®šè¡Œå‰æ’å…¥å†…å®¹ \(**file\.insert\_line**\)

#### å£°æ˜

```lua
æ“ä½œæˆè´¥ = file.insert_line(æ–‡ä»¶è·¯å¾„, è¡Œå·, å¾…æ’å…¥çš„å†…å®¹)
```

#### å‚æ•°åŠè¿”å›å€¼

- æ–‡ä»¶è·¯å¾„ *æ–‡æœ¬å‹*
- è¡Œå·
  - *æ•´æ•°å‹*ï¼Œä¼ å…¥æ­£æ•´æ•°ä»¥æŒ‡å®šè¡Œå·ï¼Œ`0` ä¸ºæœ€åä¸€è¡Œ + 1ï¼Œè´Ÿæ•°åˆ™ä¸ºå€’æ•°è¡Œå·
- å¾…æ’å…¥çš„å†…å®¹ *æ–‡æœ¬å‹*
- æ“ä½œæˆè´¥ *å¸ƒå°”å‹*

#### è¯´æ˜

åœ¨æ–‡æœ¬æ–‡ä»¶æŒ‡å®šè¡Œå‰æ’å…¥å†…å®¹ï¼Œè¡Œæ•°ä¸å¤Ÿç”¨ç©ºè¡Œè¡¥è¶³ï¼Œæ–‡ä»¶ä¸å­˜åœ¨ä¼šåˆ›å»ºæ–‡ä»¶ï¼ŒæŒ‡å®šè·¯å¾„çš„ä¸Šçº§ç›®å½•ä¸å­˜åœ¨åˆ™ä¼šè¿”å› `false`ã€‚

#### ç¤ºä¾‹

```lua title="file.insert_line"
local success = file.insert_line("/var/mobile/1.txt", 2, "å²‚å› ç¥¸ç¦é¿è¶‹ä¹‹")
if success then
  sys.alert("æ“ä½œæˆåŠŸ")
else
  sys.alert("æ“ä½œå¤±è´¥")
end
```

### ğŸ”¤ ç§»é™¤æ–‡æœ¬æ–‡ä»¶æŒ‡å®šè¡Œ \(**file\.remove\_line**\)

#### å£°æ˜

```lua
æ“ä½œæˆè´¥, è¢«åˆ é™¤è¡Œçš„å†…å®¹ = file.remove_line(æ–‡ä»¶è·¯å¾„, è¡Œå·)
```

#### å‚æ•°åŠè¿”å›å€¼

- æ–‡ä»¶è·¯å¾„ *æ–‡æœ¬å‹*
- è¡Œå·
  - *æ•´æ•°å‹*ï¼Œä¼ å…¥æ­£æ•´æ•°ä»¥æŒ‡å®šè¡Œå·ï¼Œ`0` ä¸ºæœ€åä¸€è¡Œ + 1ï¼Œè´Ÿæ•°åˆ™ä¸ºå€’æ•°è¡Œå·
- æ“ä½œæˆè´¥ *å¸ƒå°”å‹*
- è¢«åˆ é™¤è¡Œçš„å†…å®¹
  - *æ–‡æœ¬å‹*ï¼Œæ“ä½œå¤±è´¥è¿”å› `nil`

#### è¯´æ˜

- è¡Œå·ä» `1` å¼€å§‹ï¼Œå¦‚æœè¡Œå·è¶…å‡ºèŒƒå›´æˆ–æ–‡ä»¶ä¸å­˜åœ¨åˆ™è¿”å› `nil`ã€‚
- å¦‚æœè¢«ç§»é™¤çš„è¡Œä¹‹åè¿˜æœ‰å†…å®¹ï¼Œé‚£ä¹ˆåé¢è¡Œä¼šå‘å‰ç§»åŠ¨ã€‚

#### ç¤ºä¾‹

```lua title="file.remove_line"
local success, line = file.remove_line("/var/mobile/1.txt", 3)
if success then
  sys.alert("æ“ä½œæˆåŠŸï¼Œè¢«åˆ é™¤çš„è¡Œçš„å†…å®¹æ˜¯ï¼š" .. line)
else
  sys.alert("æ“ä½œå¤±è´¥")
end
```

### ğŸ”¤ è·å–ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶çš„æ‰€æœ‰è¡Œ \(**file\.get\_lines**\)

#### å£°æ˜

```lua
è¡Œæ•°ç»„ = file.get_lines(æ–‡ä»¶è·¯å¾„)
```

#### å‚æ•°åŠè¿”å›å€¼

- æ–‡ä»¶è·¯å¾„ *æ–‡æœ¬å‹*
- è¡Œæ•°ç»„
  - *æ–‡æœ¬å‹é¡ºåºè¡¨*ï¼Œæ–‡ä»¶ä¸å­˜åœ¨è¿”å› `nil`

#### è¯´æ˜

è·å–ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶çš„æ‰€æœ‰è¡Œï¼Œç©ºæ–‡ä»¶è¿”å› `{ [1] = "" }`ï¼Œæ–‡ä»¶ä¸å­˜åœ¨è¿”å› `nil`ã€‚

#### ç¤ºä¾‹

```lua title="file.get_lines"
local lines = file.get_lines("/var/mobile/1.txt")
if lines then
  lines[1] = string.strip_utf8_bom(lines[1])  -- å¤„ç†æ‰å¯èƒ½å­˜åœ¨çš„ UTF8-BOM
  if #lines[1] > 0 then
    sys.alert("æ–‡ä»¶ç¬¬ä¸€è¡Œçš„å†…å®¹æ˜¯ " .. lines[1])
  else
    sys.alert("æ–‡ä»¶æ˜¯ç©ºçš„")
  end
else
  sys.alert("æ“ä½œå¤±è´¥")
end
```

### ğŸ”¤ å°†ä¸€ä¸ªé¡ºåºè¡¨è½¬æ¢é€è¡Œè¦†ç›–å†™å…¥åˆ°æ–‡ä»¶ä¸­ \(**file\.set\_lines**\)

#### å£°æ˜

```lua
æ“ä½œæˆè´¥ = file.set_lines(æ–‡ä»¶è·¯å¾„, è¡Œæ•°ç»„)
```

#### å‚æ•°åŠè¿”å›å€¼

- æ–‡ä»¶è·¯å¾„ *æ–‡æœ¬å‹*
- è¡Œæ•°ç»„ *æ–‡æœ¬å‹é¡ºåºè¡¨*
- æ“ä½œæˆè´¥ *å¸ƒå°”å‹*

#### è¯´æ˜

å°†ä¸€ä¸ªé¡ºåºè¡¨è½¬æ¢é€è¡Œè¦†ç›–å†™å…¥åˆ°æ–‡ä»¶ä¸­ï¼Œæ–‡ä»¶ä¸å­˜åœ¨ä¼šåˆ›å»ºæ–‡ä»¶ï¼ŒæŒ‡å®šè·¯å¾„çš„ä¸Šçº§ç›®å½•ä¸å­˜åœ¨åˆ™ä¼šè¿”å› `false`ã€‚

#### ç¤ºä¾‹

```lua title="file.set_lines"
local success = file.set_lines("/var/mobile/1.txt", {
  "è‹Ÿåˆ©å›½å®¶ç”Ÿæ­»ä»¥",
  "å²‚å› ç¥¸ç¦é¿è¶‹ä¹‹",
})
if success then
  sys.alert("+1s")
else
  sys.alert("æ“ä½œå¤±è´¥")
end
```

### ğŸ”¤ å°†ä¸€ä¸ªé¡ºåºè¡¨è½¬æ¢é€è¡Œæ’å…¥åˆ°æ–‡ä»¶æŒ‡å®šè¡Œå‰ \(**file\.insert\_lines**\)

#### å£°æ˜

```lua
æ“ä½œæˆè´¥ = file.insert_lines(æ–‡ä»¶è·¯å¾„, è¡Œå·, è¡Œæ•°ç»„)
```

#### å‚æ•°åŠè¿”å›å€¼

- æ–‡ä»¶è·¯å¾„ *æ–‡æœ¬å‹*
- è¡Œå·
  - *æ•´æ•°å‹*ï¼Œä¼ å…¥æ­£æ•´æ•°ä»¥æŒ‡å®šè¡Œå·ï¼Œ`0` ä¸ºæœ€åä¸€è¡Œ + 1ï¼Œè´Ÿæ•°åˆ™ä¸ºå€’æ•°è¡Œå·
- è¡Œæ•°ç»„ *æ–‡æœ¬å‹é¡ºåºè¡¨*
- æ“ä½œæˆè´¥ *å¸ƒå°”å‹*

#### è¯´æ˜

å°†ä¸€ä¸ªé¡ºåºè¡¨è½¬æ¢é€è¡Œæ’å…¥åˆ°æ–‡ä»¶æŒ‡å®šè¡Œå‰ï¼Œæ–‡ä»¶ä¸å­˜åœ¨ä¼šåˆ›å»ºæ–‡ä»¶ï¼ŒæŒ‡å®šè·¯å¾„çš„ä¸Šçº§ç›®å½•ä¸å­˜åœ¨åˆ™ä¼šè¿”å› `false`ã€‚

#### ç¤ºä¾‹

```lua title="file.insert_lines"
local success = file.insert_lines("/var/mobile/1.txt", 0, { -- å°†ä¸‹é¢ä¸¤è¡Œå­—è¿½åŠ åˆ°æ–‡ä»¶æœ«å°¾
  "I will do whatever it takes to serve my country even at the cost of my own life,",
  "regardless of fortune or misfortune to myself.",
})
if success then
  sys.alert("+1s")
else
  sys.alert("æ“ä½œå¤±è´¥")
end
```
